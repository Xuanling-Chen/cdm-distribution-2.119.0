

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Common Domain Model &mdash; ISDA CDM 2.119.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to the ISDA CDM documentation!" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ISDA CDM
          

          
          </a>

          
            
            
              <div class="version">
                2.119.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Common Domain Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#product-model">Product Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tradableproduct">TradableProduct</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tradelot">TradeLot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pricequantity">PriceQuantity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#measurebase">MeasureBase</a></li>
<li class="toctree-l4"><a class="reference internal" href="#price">Price</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quantity">Quantity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#observable">Observable</a></li>
<li class="toctree-l4"><a class="reference internal" href="#financial-product">Financial Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="#settlement-instructions">Settlement Instructions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#contractual-product">Contractual Product</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#economic-terms">Economic Terms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#payout">Payout</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reusable-components">Reusable Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#underlier">Underlier</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-templates">Data Templates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#products-with-identifiers">Products with Identifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#product-qualification">Product Qualification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#event-model">Event Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#trade-state">Trade State</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#trade">Trade</a></li>
<li class="toctree-l4"><a class="reference internal" href="#executiondetails-and-contractdetails">ExecutionDetails and ContractDetails</a></li>
<li class="toctree-l4"><a class="reference internal" href="#state">State</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#primitive-event">Primitive Event</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-1-execution-and-contract-formation">Example 1: Execution and Contract Formation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-2-reset">Example 2: Reset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-3-transfer">Example 3: Transfer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#business-event">Business Event</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#intent">Intent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-effect">Event Effect</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-misc-information">Other Misc. Information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#workflow">Workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Business Event</a></li>
<li class="toctree-l4"><a class="reference internal" href="#proposed-instruction">Proposed Instruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#previous-workflow-step">Previous Workflow Step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#action">Action</a></li>
<li class="toctree-l4"><a class="reference internal" href="#message-information">Message Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestamp">Timestamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-identifier">Event Identifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-misc-attributes">Other Misc. Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#event-qualification">Event Qualification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#legal-agreements">Legal Agreements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-use-of-agreements-in-financial-markets">The Use of <em>Agreements</em> in Financial Markets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-agreements-in-the-cdm">Legal Agreements in the CDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modelling-approach">Modelling Approach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scope">Scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="#design-principles">Design Principles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#legal-agreement-data-structure">Legal Agreement Data Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#agreement-identification">Agreement Identification</a></li>
<li class="toctree-l4"><a class="reference internal" href="#related-agreement">Related Agreement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#umbrella-agreement">Umbrella Agreement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agreement-content">Agreement Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agreement">Agreement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#counterparty">Counterparty</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#elective-provisions">Elective Provisions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Modelling Approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="#election-structure">Election Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elective-provisions-example-1-posting-obligations">Elective Provisions Example 1: Posting Obligations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elective-provisions-example-2-security-agreement-elections">Elective Provisions Example 2: Security Agreement Elections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elective-provisions-example-3-credit-support-obligations">Elective Provisions Example 3: Credit Support Obligations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#linking-legal-agreements-to-contracts">Linking Legal Agreements to Contracts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#process-model">Process Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#purpose">Purpose</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#why-a-process-model">Why a Process Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-is-the-process-model">What Is the Process Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-does-it-work">How Does It Work</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Scope</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coverage">Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#granularity">Granularity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#validation-process">Validation Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#product-validation">Product Validation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-process">Calculation Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#base-libraries-vector-math">Base Libraries - Vector Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="#base-libraries-date-math">Base Libraries - Date Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fixed-amount-and-floating-amount-definitions">Fixed Amount and Floating Amount Definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#day-count-fraction">Day Count Fraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#utility-function">Utility Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#equity-performance">Equity Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initial-margin">Initial Margin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#billing">Billing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lifecycle-event-process">Lifecycle Event Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#primitive-creation">Primitive Creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workflow-step-creation">Workflow Step Creation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reference-data-model">Reference Data Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mapping-synonym">Mapping (Synonym)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#namespace">Namespace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-artifacts">Model Artifacts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#organising-principles">Organising Principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hierarchy-structure">Hierarchy Structure</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ISDA CDM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The Common Domain Model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/documentation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-common-domain-model">
<h1>The Common Domain Model<a class="headerlink" href="#the-common-domain-model" title="Permalink to this headline">¶</a></h1>
<p><strong>There are seven modelling dimensions</strong> to the CDM:</p>
<ul class="simple">
<li>Product</li>
<li>Event</li>
<li>Legal Agreement</li>
<li>Process</li>
<li>Reference Data</li>
<li>Mapping (Synonym)</li>
<li>Namespace</li>
</ul>
<p>The following sections define each of these dimensions. Selected examples of model definitions are used as illustrations to help explain each dimension and include, where applicable, data samples to help demonstrate the structure. All the Rosetta DSL modelling components that are used to express the CDM are described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html">Rosetta DSL Documentation</a></p>
<p>The complete model definition, including descriptions and other details can be viewed in the <a class="reference external" href="https://portal.cdm.rosetta-technology.io/#/text-browser">Textual Browser</a> on the ISDA CDM Portal.</p>
<div class="section" id="product-model">
<h2>Product Model<a class="headerlink" href="#product-model" title="Permalink to this headline">¶</a></h2>
<p>Where applicable, the CDM follows the data structure of the Financial Products Markup Language (FpML), which is widely used in the OTC Derivatives market.  For example, the CDM type <code class="docutils literal notranslate"><span class="pre">PayerReceiver</span></code> is equivalent to the FpML PayerReceiver.model. Both of these are data structures used frequently throughout each respective model. In other cases, the CDM data structure is more normalised, per requirements from the CDM Design Working Group.  For example, price and quantity are represented in a single type, <code class="docutils literal notranslate"><span class="pre">TradableProduct</span></code>, which is shared by all products. Another example is the use of a composable product model whereby:</p>
<ul class="simple">
<li><strong>Economic terms are specified by composition</strong>, For example, the <code class="docutils literal notranslate"><span class="pre">InterestRatePayout</span></code> type is a component used in the definition of any product with one or more interest rate legs (e.g. Interest Rate Swaps, Equity Swaps, and Credit Default Swaps).</li>
<li><strong>Product qualification is inferred</strong> from those economic terms rather than explicitly naming the product type, whereas FpML qualifies the product explcitly through the <em>product</em> substitution group.</li>
</ul>
<p>Regardless of whether the data structure is the same or different from FpML, the CDM includes defined Synonyms that map to FpML (and other models) and can be used for transformation purposes. More details on Synonyms are provided in the Mapping (Synonym) section of this document.</p>
<div class="section" id="tradableproduct">
<h3>TradableProduct<a class="headerlink" href="#tradableproduct" title="Permalink to this headline">¶</a></h3>
<p>A tradable product represents a financial product that is ready to be traded, meaning that there is an agreed financial product, price, quantity, and other details necessary to complete an execution of a security or a negotiated contract between two counterparties. Tradable products are represented by the <code class="docutils literal notranslate"><span class="pre">TradableProduct</span></code> type.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">TradableProduct:</span>
   <span class="n">product</span> <span class="kt">Product</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">tradeLot</span> <span class="kt">TradeLot</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
   <span class="n">counterparty</span> <span class="kt">Counterparty</span> <span class="p">(</span><span class="mi">2</span><span class="o">..</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">ancillaryParty</span> <span class="kt">AncillaryParty</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
   <span class="n">settlementInstructions</span> <span class="kt">SettlementInstructions</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
   <span class="n">adjustment</span> <span class="kt">NotionalAdjustmentEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The conditions for this data type are excluded from the snippet above for purposes of brevity.</p>
</div>
<p>The primary set of attributes represented in the <code class="docutils literal notranslate"><span class="pre">TradableProduct</span></code> data type are ones that are shared by all trades and transactions.  For example, every trade has a price, a quantity (treated jointly as a trade lot), and a pair of counterparties.  In some cases, there are ancillary parties, settlement terms, and an allowable adjustment to the notional quantity.  All of the other attributes required to describe a product are defined in distinct product data types.</p>
<div class="section" id="tradelot">
<h4>TradeLot<a class="headerlink" href="#tradelot" title="Permalink to this headline">¶</a></h4>
<p>A trade lot represents the quantity and price at which a product is being traded.</p>
<p>In certain markets, trading the same product with the same economics (except for price and quantity) and the same counterparty may be treated as a separate trade. Each trade is represented by a tradable product containing only 1 trade lot. In other markets, trading the same product with the same characteristics (except for price and quantity) is represented as part of the same trade. In this case, a single tradable product contains multiple trade lots represented as an array of the <code class="docutils literal notranslate"><span class="pre">TradeLot</span></code> data type.</p>
<p>When a trade can have multiple trade lots, increases (or upsize) and decreases (or unwind) are treated differently. An increase adds a new <code class="docutils literal notranslate"><span class="pre">TradeLot</span></code> instance to the tradadable product, whereas a decrease reduces the quantity of one or more of the existing trade lots.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The term <em>lot</em> is borrowed from the Equity terminology that refers to each trade lot as a <em>tax lot</em>, where the capital gains tax that may arise upon unwind is calculated based on the price at which the lot was entered.</p>
</div>
<p>For each trade lot, the quantity and price are represente by an attribute called <code class="docutils literal notranslate"><span class="pre">priceQuantity</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">TradeLot:</span>
  <span class="n">lotIdentifier</span> <span class="kt">Identifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">priceQuantity</span> <span class="kt">PriceQuantity</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pricequantity</span></code> attribute is represented as an array of the <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> data type. For composite financial products that are made of different legs, each leg may require its own price and quantity attributes, and each instance of a <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> data type identifies the relevant information for the leg of a trade. For example, for an Interest Rate Swap, a trade lot would have one instance of the <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> data type for each interest leg, and potentially a third one for an upfront fee.  By comparison, the purchase or sale of a security or listed derivative would typically have a single <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> instance in the trade lot.</p>
</div>
<div class="section" id="pricequantity">
<h4>PriceQuantity<a class="headerlink" href="#pricequantity" title="Permalink to this headline">¶</a></h4>
<p>The price and quantity attributes of a trade, or of a leg of a trade in the case of composite products, are part of a data type called <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code>. This data type also contains (optionally) an observable, which describes the asset or reference index to which the price and quantity are related, and a date, which indicates when these price and quantity become effective.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">PriceQuantity:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">price</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">location</span><span class="p">]</span>
  <span class="n">quantity</span> <span class="kt">Quantity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">location</span><span class="p">]</span>
  <span class="n">observable</span> <span class="kt">Observable</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">effectiveDate</span> <span class="kt">AdjustableOrRelativeDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The conditions for this data type are excluded from the snippet above for purposes of brevity.</p>
</div>
<p>The price, quantity and observable attributes are joined together in a single <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> data type because in some cases, those 3 attributes need to be considered together. For example, the return leg of an Equity Swap will have:</p>
<ul class="simple">
<li>the identifier for the shares as <code class="docutils literal notranslate"><span class="pre">observable</span></code></li>
<li>the number of shares as <code class="docutils literal notranslate"><span class="pre">quantity</span></code></li>
<li>the initial share price as <code class="docutils literal notranslate"><span class="pre">price</span></code></li>
</ul>
<p>However, those attributes are optional because in other cases, only some of them will be specified. In the fixed leg of an Interest Rate Swap, there is no observable as the rate is already fixed. An option trade will contain an instance of a <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> containing only the premium as price attribute, but no quantity or observable (the quantity and/or observable for the option underlyer will be specified in a different <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> instance).</p>
<p>Both the price and quantity can be specified as arrays in a single <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code>. All elements in the array express the same values but according to different conventions. For example, the return leg of an Equity Swap may specify both the number of shares and the notional (a currency amount equal to: number of shares x price per share) as quantities. In a Forward FX trade, the spot rate, forward points and forward rate (equal to spot rate + forward points) may all be specified as prices. When mutiple values are specified for either the price or quantity attributes in a single <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> instance, they will be tied by rules that enforce that they are internally consistent.</p>
<p>The effective date attribute is optional and will usually be specified when a single trade has multiple trade lots, to indicate when each trade lot become effective (usually on or around the date when the lot was traded). The trade itself will have an effective date, corresponding to the date when the first lot was traded and the trade opened.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">price</span></code> and <code class="docutils literal notranslate"><span class="pre">quantity</span></code> attributes in the <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> data type each have a metadata location which can reference a metadata address in one of the  <code class="docutils literal notranslate"><span class="pre">Payout</span></code> data types.  The metadata address-location pair allows for a reference to link objects without populating the address object in persistence.  This capability helps to support an agnostic definition of the product in a trade (i.e. a product definition without a price and quantity). However, the reference can be used to populate values for an input into a function or for other purposes.</p>
</div>
<div class="section" id="measurebase">
<h4>MeasureBase<a class="headerlink" href="#measurebase" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">MeasureBase</span></code> is a base data type that provides a common component that is useful in the definition of prices and quantities, as defined below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">MeasureBase:</span>
       <span class="n">amount</span> <span class="n">number</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">unitOfAmount</span> <span class="kt">UnitType</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MeasureBase</span></code> data type consists of two mandatory attributes.  The first is <code class="docutils literal notranslate"><span class="pre">amount</span></code>, which could be a price or a quantity, as defined by other attributes.  The second attribute is <code class="docutils literal notranslate"><span class="pre">unitOfAmount</span></code>, which uses the <code class="docutils literal notranslate"><span class="pre">UnitType</span></code> data type. This data type requires the definition of units using one of five defined types:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">UnitType:</span>
       <span class="n">capacityUnit</span> <span class="kt">CapacityUnitEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">weatherUnit</span> <span class="kt">WeatherUnitEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">financialUnit</span> <span class="kt">FinancialUnitEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">currency</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
       <span class="n">frequency</span> <span class="n">cdm</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="kt">Frequency</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

       <span class="n">condition</span><span class="kt">:</span><span class="n">one</span><span class="o">-</span><span class="kr">of</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Price</span></code> and <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> data types are both extensions of the <code class="docutils literal notranslate"><span class="pre">MeasureBase</span></code> data type, as shown below:</p>
</div>
<div class="section" id="price">
<h4>Price<a class="headerlink" href="#price" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Price</span></code> data type extends the <code class="docutils literal notranslate"><span class="pre">MeasureBase</span></code> data type with the addition of the <code class="docutils literal notranslate"><span class="pre">priceType</span></code> and <code class="docutils literal notranslate"><span class="pre">perUnitOfAmount</span></code> attributes, which together further qualify the price.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Price</span> <span class="n">extends</span> <span class="kt">MeasureBase:</span>
       <span class="n">priceType</span> <span class="kt">PriceTypeEnum</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">perUnitOfAmount</span> <span class="kt">UnitType</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the conditions for this data type are excluded from the snippet above for purposes of brevity.</p>
<p>Consider the example below for the initial price of the underlying equity in a single-name Equity Swap, which is a net price of 37.44 USD per Share:</p>
<div class="highlight-Javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;price&quot;</span><span class="o">:</span> <span class="p">[</span>
           <span class="p">{</span>
             <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;amount&quot;</span><span class="o">:</span> <span class="mf">37.44</span><span class="p">,</span>
               <span class="s2">&quot;unitOfAmount&quot;</span><span class="o">:</span> <span class="p">{</span>
                 <span class="s2">&quot;currency&quot;</span><span class="o">:</span> <span class="p">{</span>
                   <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;USD&quot;</span>
                 <span class="p">}</span>
               <span class="p">},</span>
               <span class="s2">&quot;perUnitOfAmount&quot;</span><span class="o">:</span> <span class="p">{</span>
                 <span class="s2">&quot;financialUnit&quot;</span><span class="o">:</span> <span class="s2">&quot;SHARE&quot;</span>
               <span class="p">},</span>
               <span class="s2">&quot;priceType&quot;</span><span class="o">:</span> <span class="s2">&quot;NET_PRICE&quot;</span>
             <span class="p">},</span>
             <span class="s2">&quot;meta&quot;</span><span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="p">[</span>
                 <span class="p">{</span>
                   <span class="s2">&quot;scope&quot;</span><span class="o">:</span> <span class="s2">&quot;DOCUMENT&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;price-1&quot;</span>
                 <span class="p">}</span>
               <span class="p">]</span>
             <span class="p">}</span>
           <span class="p">}</span>
         <span class="p">]</span>
</pre></div>
</div>
<p>The full form of this example can be seen in the CDM Portal Ingestion panel, products-&gt;equity-&gt;eqs-ex01-single-underlyer-execution-long-form-other-party.xml.  As can be seen in the full example, for an interest rate leg, the <code class="docutils literal notranslate"><span class="pre">unitOfAmount</span></code> and the <code class="docutils literal notranslate"><span class="pre">perUnitOfAmount</span></code> would both be a currency, (e.g. 0.002 USD per USD) and the priceType would be a Spread (in the case of a floating leg, as in this example) or an InterestRate (in the case of a fixed leg).</p>
</div>
<div class="section" id="quantity">
<h4>Quantity<a class="headerlink" href="#quantity" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> data type extends the <code class="docutils literal notranslate"><span class="pre">MeasureBase</span></code> data type with the addition of the optonal attributes <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> and <code class="docutils literal notranslate"><span class="pre">multiplierUnit</span></code> attributes.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Quantity</span> <span class="n">extends</span> <span class="kt">MeasureBase:</span>
       <span class="n">multiplier</span> <span class="n">number</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">multiplierUnit</span> <span class="kt">UnitType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

       <span class="n">condition</span> <span class="kt">Quantity_multiplier:</span>
           <span class="kr">if</span> <span class="n">multiplier</span> <span class="n">exists</span>
               <span class="kr">then</span> <span class="n">multiplier</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>The two inherited attributes of <code class="docutils literal notranslate"><span class="pre">amount</span></code> and <code class="docutils literal notranslate"><span class="pre">unitOfAmount</span></code> are sufficient to define quantity, in most cases.  The two attributes that are distinct for the <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> data type   further qualify the <code class="docutils literal notranslate"><span class="pre">amount</span></code>, with a multiplier, as needed for listed contracts or other purposes, as shown in the example below:</p>
<div class="highlight-Javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="p">[</span>
           <span class="p">{</span>
             <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;amount&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
               <span class="s2">&quot;unitOfAmount&quot;</span><span class="o">:</span> <span class="p">{</span>
                 <span class="s2">&quot;financialUnit&quot;</span><span class="o">:</span> <span class="s2">&quot;CONTRACT&quot;</span>
               <span class="p">},</span>
               <span class="s2">&quot;multiplier&quot;</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span>
               <span class="s2">&quot;multiplierUnit&quot;</span><span class="o">:</span> <span class="s2">&quot;BBL&quot;</span>
             <span class="p">},</span>
             <span class="s2">&quot;meta&quot;</span><span class="o">:</span> <span class="p">{</span>
               <span class="s2">&quot;location&quot;</span><span class="o">:</span> <span class="p">[</span>
                 <span class="p">{</span>
                   <span class="s2">&quot;scope&quot;</span><span class="o">:</span> <span class="s2">&quot;DOCUMENT&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;quantity-1&quot;</span>
                 <span class="p">}</span>
               <span class="p">]</span>
             <span class="p">}</span>
           <span class="p">}</span>
          <span class="p">]</span>
</pre></div>
</div>
<p>In this case, the trade involves the purchase or sale of 200 contracts of the WTI Crude Oil futures contract on the CME.  Each contract represents 1,000 barrels, therefore the total quantity of the trade is for 200,000 barrels.</p>
</div>
<div class="section" id="observable">
<h4>Observable<a class="headerlink" href="#observable" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Observable</span></code> data type specifies the reference object to be observed for a price, which could be an underlying asset or a reference such as an index.</p>
<p>he Observable data type requires the specification of either a <code class="docutils literal notranslate"><span class="pre">rateOption</span></code> (i.e. a floating rate index), <code class="docutils literal notranslate"><span class="pre">commodity</span></code>, <code class="docutils literal notranslate"><span class="pre">productIdentifier</span></code>, or <code class="docutils literal notranslate"><span class="pre">currencypair</span></code>. This choice constraint is supported by specifying a one-of condition, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Observable:</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
       <span class="n">rateOption</span> <span class="kt">FloatingRateOption</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">location</span><span class="p">]</span>
       <span class="n">commodity</span> <span class="kt">Commodity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">location</span><span class="p">]</span>
       <span class="n">productIdentifier</span> <span class="kt">ProductIdentifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">location</span><span class="p">]</span>
       <span class="n">currencyPair</span> <span class="kt">QuotedCurrencyPair</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">location</span><span class="p">]</span>

       <span class="n">condition</span><span class="kt">:</span> <span class="n">one</span><span class="o">-</span><span class="kr">of</span>
</pre></div>
</div>
</div>
<div class="section" id="financial-product">
<h4>Financial Product<a class="headerlink" href="#financial-product" title="Permalink to this headline">¶</a></h4>
<p>A financial product is an instrument that is used to transfer financial risk between two parties. Financial products are represented in the <code class="docutils literal notranslate"><span class="pre">Product</span></code> type, which is also constrained by a <code class="docutils literal notranslate"><span class="pre">one-of</span></code> condition, meaning that for a single Tradable Product, there can only be one Product.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Product:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">contractualProduct</span> <span class="kt">ContractualProduct</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">index</span> <span class="kt">Index</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">loan</span> <span class="kt">Loan</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">foreignExchange</span> <span class="kt">ForeignExchange</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">commodity</span> <span class="kt">Commodity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">address</span> <span class="s">&quot;pointsTo&quot;</span><span class="ow">=</span><span class="kt">Observable</span><span class="ow">-&gt;</span><span class="n">commodity</span><span class="p">]</span>
  <span class="n">security</span> <span class="kt">Security</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">condition</span><span class="kt">:</span> <span class="n">one</span><span class="o">-</span><span class="kr">of</span>
</pre></div>
</div>
<p>The CDM allows any one of these products to included in a trade or used as an underlier for another product (see the <em>Underlier</em> section). One unlikely case for a direct trade is Index, which is primarily used as an underlier.</p>
<p>Among this set of products, the contractual product is the most complicated and requires the largest data structure. In a contractual product, an exchange of financial risk is materialised by a unique bilateral contract that specifies the financial obligations of each party. The terms of the contract are specified at trade inception and apply throughout the life of the contract (which can last for decades for certain long-dated products), unless amended by mutual agreement. Contractual products are fungible (in other words, replaceable by other identical or similar contracts) only under specific terms: e.g.&nbsp;the existence of a close-out netting agreement between the parties.</p>
<p>Given that each contractual product transaction is unique, all of the contract terms must be specified and stored in an easily accessible transaction lifecycle model so that each party can evaluate the financial and counterparty risks during the life of the agreement.</p>
<p>Foreign Exchange (FX) spot and forward trades (including Non-Deliverable Forwards) and private loans also represent an exchange of financial risk represented by a form of bilateral agreements. FX forwards and private loans can have an extended term, and are generally not fungible. However, these products share few other commonalities with contractual products such as Interest Rate Swaps. Therefore, they are defined separately.</p>
<p>By contrast, in the case of the execution of a security (e.g. a listed equity), the exchange of finanical risk is a one-time event that takes place on the settlement date, which is usually within a few business days of the agreement. The other significant distinction is that securities are fungible instruments for which the terms and security identifiers are publically available.  Therefore, the terms of the security do not have to be stored in a transaction lifecycle model, but can be referenced with public identifiers.</p>
<p>An Index product is an exception because it’s not directly tradable, but is included here because it can be referenced as an underlier for a tradable product and can be identified by a public identifier.</p>
</div>
<div class="section" id="settlement-instructions">
<h4>Settlement Instructions<a class="headerlink" href="#settlement-instructions" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">settlementInstructions</span></code> attribute defines how the transaction should be settled (including the settlement date). For instance, a settlement could be a <em>delivery-versus-payment</em> scenario for a cash security transaction or a <em>payment-versus-payment</em> scenario for an FX spot or forward transaction. The actual settlement amount(s) will need to use the <em>price</em> and <em>quantity</em> agreed as part of the tradable product.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">SettlementInstructions</span> <span class="n">extends</span> <span class="kt">PayoutBase:</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">PayoutBase:</span>
  <span class="n">payerReceiver</span> <span class="kt">PayerReceiver</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">payoutQuantity</span> <span class="kt">ResolvablePayoutQuantity</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">settlementTerms</span> <span class="kt">SettlementTerms</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">SettlementTerms</span> <span class="n">extends</span> <span class="kt">SettlementBase:</span>
  <span class="n">cashSettlementTerms</span> <span class="kt">CashSettlementTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">physicalSettlementTerms</span> <span class="kt">PhysicalSettlementTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="contractual-product">
<h3>Contractual Product<a class="headerlink" href="#contractual-product" title="Permalink to this headline">¶</a></h3>
<p>The scope of contractual products in the current model are summarized below:</p>
<ul class="simple">
<li><strong>Interest rate derivatives</strong>:<ul>
<li>Interest Rate Swaps (incl. cross-currency swaps, non-deliverable swaps, basis swaps, swaps with  non-regular periods, …)</li>
<li>Swaptions</li>
<li>Caps/floors</li>
<li>FRAs</li>
<li>OTC Options on Bonds</li>
</ul>
</li>
<li><strong>Credit derivatives</strong>:<ul>
<li>Credit Default Swaps (incl. baskets, tranche, swaps with mortgage and loans underlyers, …)</li>
<li>Options on Credit Default Swaps</li>
</ul>
</li>
<li><strong>Equity derivatives</strong>:<ul>
<li>Equity Swaps (single name)</li>
</ul>
</li>
<li><strong>Options</strong>:<ul>
<li>Any other OTC Options (incl. FX Options)</li>
</ul>
</li>
<li><strong>Securities Lending</strong>:<ul>
<li>Single underlyer, cash collateralised, open/term security loan</li>
</ul>
</li>
</ul>
<p>In the CDM, contractual products are represented by the <code class="docutils literal notranslate"><span class="pre">ContractualProduct</span></code> type:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ContractualProduct:</span>
   <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
   <span class="p">[</span><span class="n">metadata</span> <span class="n">template</span><span class="p">]</span>
   <span class="n">productIdentification</span> <span class="kt">ProductIdentification</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">productTaxonomy</span> <span class="kt">ProductTaxonomy</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
   <span class="n">economicTerms</span> <span class="kt">EconomicTerms</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that price and quantity are defined in <code class="docutils literal notranslate"><span class="pre">TradableProduct</span></code> as these are attributes common to all products.  The remaining economic terms of the contractual product are defined in <code class="docutils literal notranslate"><span class="pre">EconomicTerms</span></code> which is an encapsulated type in <code class="docutils literal notranslate"><span class="pre">ContractualProduct</span></code> .</p>
<div class="section" id="economic-terms">
<h4>Economic Terms<a class="headerlink" href="#economic-terms" title="Permalink to this headline">¶</a></h4>
<p>The CDM specifies the various sets of possible remaining economic terms using the <code class="docutils literal notranslate"><span class="pre">EconomicTerms</span></code> type.  This type includes contractual provisions that are not specific to the type of payout, but do impact the value of the contract, such as effective date, termination date, date adjustments, and early termination provisions.  A valid population of this type is constrained by a set of conditions which are not shown here in the interests of brevity.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">EconomicTerms:</span>
  <span class="n">effectiveDate</span> <span class="kt">AdjustableOrRelativeDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">terminationDate</span> <span class="kt">AdjustableOrRelativeDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">dateAdjustments</span> <span class="kt">BusinessDayAdjustments</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">payout</span> <span class="kt">Payout</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">earlyTerminationProvision</span> <span class="kt">EarlyTerminationProvision</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">optionProvision</span> <span class="kt">OptionProvision</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">extraordinaryEvents</span> <span class="kt">ExtraordinaryEvents</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="payout">
<h4>Payout<a class="headerlink" href="#payout" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Payout</span></code> type defines the composable payout types, each of which describes a set of terms and conditions for the financial responsibilities between the contractual parties. Payout types can be combined to compose a product.  For example, an Equity Swap can be composed by combining an <code class="docutils literal notranslate"><span class="pre">InterestRatePayout</span></code> and an <code class="docutils literal notranslate"><span class="pre">EquityPayout</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Payout:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">interestRatePayout</span> <span class="kt">InterestRatePayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">creditDefaultPayout</span> <span class="kt">CreditDefaultPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">equityPayout</span> <span class="kt">EquityPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">optionPayout</span> <span class="kt">OptionPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">commodityPayout</span> <span class="kt">CommodityPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">forwardPayout</span> <span class="kt">ForwardPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">fixedForwardPayout</span> <span class="kt">FixedForwardPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">securityPayout</span> <span class="kt">SecurityPayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">securityFinancePayout</span> <span class="kt">SecurityFinancePayout</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">cashflow</span> <span class="kt">Cashflow</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">InterestRatePayout</span></code>, <code class="docutils literal notranslate"><span class="pre">EquityPayout</span></code>, <code class="docutils literal notranslate"><span class="pre">OptionPayout</span></code>, <code class="docutils literal notranslate"><span class="pre">SecurityFinancePayout</span></code>, <code class="docutils literal notranslate"><span class="pre">Cashflow</span></code>, and the <code class="docutils literal notranslate"><span class="pre">ProtectionTerms</span></code> data type encapsulated in <code class="docutils literal notranslate"><span class="pre">CreditDefaultPayout</span></code> are all extensions of the base type called <code class="docutils literal notranslate"><span class="pre">PayoutBase</span></code>, which provides a common location for referencing payout quantities, as illustrated below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">PayoutBase:</span>
       <span class="n">payerReceiver</span> <span class="kt">PayerReceiver</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">payoutQuantity</span> <span class="kt">ResolvablePayoutQuantity</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">settlementTerms</span> <span class="kt">SettlementTerms</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ResolvablePayoutQuantity:</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
       <span class="n">resolvedQuantity</span> <span class="kt">Quantity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">address</span> <span class="s">&quot;pointsTo&quot;</span><span class="ow">=</span><span class="kt">PriceQuantity</span><span class="ow">-&gt;</span><span class="n">quantity</span><span class="p">]</span>
       <span class="n">quantitySchedule</span> <span class="kt">NonNegativeQuantitySchedule</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">quantityReference</span> <span class="kt">ResolvablePayoutQuantity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
       <span class="n">quantityMultiplier</span> <span class="kt">QuantityMultiplier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">reset</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">futureValueNotional</span> <span class="kt">FutureValueAmount</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the code snippet above excludes the conditions in this data type for purposes of brevity.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">resolvedQuantity</span></code> attribute has a metadata address that points to the quantity attribute in the <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code> data type.  This metadata address allows for referencing a value without requiring the population of the value in the persistent object.  The other attributes in this data type support the definition of additional information such as a schedule, a reference, or the indication that the quantity is resettable.  One of the data types that extends <code class="docutils literal notranslate"><span class="pre">PayoutBase</span></code> is <code class="docutils literal notranslate"><span class="pre">InterestRatePayout</span></code>, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">InterestRatePayout</span> <span class="n">extends</span> <span class="kt">PayoutBase:</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
       <span class="n">rateSpecification</span> <span class="kt">RateSpecification</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">dayCountFraction</span> <span class="kt">DayCountFractionEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
       <span class="n">calculationPeriodDates</span> <span class="kt">CalculationPeriodDates</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">paymentDates</span> <span class="kt">PaymentDates</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">paymentDate</span> <span class="kt">AdjustableDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">paymentDelay</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">resetDates</span> <span class="kt">ResetDates</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">discountingMethod</span> <span class="kt">DiscountingMethod</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">compoundingMethod</span> <span class="kt">CompoundingMethodEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">cashflowRepresentation</span> <span class="kt">CashflowRepresentation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">principalExchanges</span> <span class="kt">PrincipalExchanges</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">stubPeriod</span> <span class="kt">StubPeriod</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">bondReference</span> <span class="kt">BondReference</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">fixedAmount</span> <span class="n">calculation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">floatingAmount</span> <span class="n">calculation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the code snippet above excludes the conditions in this data type for purposes of brevity.</p>
<p>There are other addresses in the model that use the metadata address to point to <code class="docutils literal notranslate"><span class="pre">Price</span></code> in <code class="docutils literal notranslate"><span class="pre">PriceQuantity</span></code>.  Examples include the <code class="docutils literal notranslate"><span class="pre">initialValue</span></code> attribute in the <code class="docutils literal notranslate"><span class="pre">RateSchedule</span></code> data type and the <code class="docutils literal notranslate"><span class="pre">strikePrice</span></code> attribute in the <code class="docutils literal notranslate"><span class="pre">OptionStrike</span></code> data type, which are illustrated below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">RateSchedule:</span>
       <span class="n">initialValue</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">address</span> <span class="s">&quot;pointsTo&quot;</span><span class="ow">=</span><span class="kt">PriceQuantity</span><span class="ow">-&gt;</span><span class="n">price</span><span class="p">]</span>
       <span class="n">step</span> <span class="kt">Step</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">OptionStrike:</span>
       <span class="n">strikePrice</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">strikeReference</span> <span class="kt">FixedRateSpecification</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
       <span class="n">referenceSwapCurve</span> <span class="kt">ReferenceSwapCurve</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">averagingStrikeFeature</span> <span class="kt">AveragingObservation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">condition</span><span class="kt">:</span> <span class="n">one</span><span class="o">-</span><span class="kr">of</span>
</pre></div>
</div>
</div>
<div class="section" id="reusable-components">
<h4>Reusable Components<a class="headerlink" href="#reusable-components" title="Permalink to this headline">¶</a></h4>
<p>There are a number of components that are reusable across several payout types.  For example,  the <code class="docutils literal notranslate"><span class="pre">CalculationPeriodDates</span></code> class describes the inputs for the underlying schedule of a stream of payments.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">CalculationPeriodDates:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">effectiveDate</span> <span class="kt">AdjustableOrRelativeDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">terminationDate</span> <span class="kt">AdjustableOrRelativeDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">calculationPeriodDatesAdjustments</span> <span class="kt">BusinessDayAdjustments</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">firstPeriodStartDate</span> <span class="kt">AdjustableOrRelativeDate</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">firstRegularPeriodStartDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">firstCompoundingPeriodEndDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">lastRegularPeriodEndDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">stubPeriodType</span> <span class="kt">StubPeriodTypeEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">calculationPeriodFrequency</span> <span class="kt">CalculationPeriodFrequency</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="underlier">
<h4>Underlier<a class="headerlink" href="#underlier" title="Permalink to this headline">¶</a></h4>
<p>The underlier attribute on types <code class="docutils literal notranslate"><span class="pre">OptionPayout</span></code>, <code class="docutils literal notranslate"><span class="pre">ForwardPayout</span></code> and <code class="docutils literal notranslate"><span class="pre">EquityPayout</span></code> allows for any product to be used as the underlier for a corresponding products option, forward, and equity swap.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">OptionPayout</span> <span class="n">extends</span> <span class="kt">PayoutBase:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">buyerSeller</span> <span class="kt">BuyerSeller</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">optionType</span> <span class="kt">OptionTypeEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">feature</span> <span class="kt">OptionFeature</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">exerciseTerms</span> <span class="kt">OptionExercise</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">underlier</span> <span class="kt">Product</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This nesting of the product component is another example of a composable product model. One use case is an interest rate swaption for which the high-level product uses the <code class="docutils literal notranslate"><span class="pre">OptionPayout</span></code> type and underlier is an Interest Rate Swap composed of two <code class="docutils literal notranslate"><span class="pre">InterestRatePayout</span></code> types. Similiarly, the product underlying an Equity Swap composed of an <code class="docutils literal notranslate"><span class="pre">InterestRatePayout</span></code> and an <code class="docutils literal notranslate"><span class="pre">EquityPayout</span></code> would be a non-contractual product: an equity security.</p>
</div>
<div class="section" id="data-templates">
<h4>Data Templates<a class="headerlink" href="#data-templates" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">ContractualProduct</span></code> type is specified with the <code class="docutils literal notranslate"><span class="pre">[metadata</span> <span class="pre">template]</span></code> annotation indicating that it is eligible to be used as a template.</p>
<p>Financial markets often trade a high volume of trades with near identical contractual product data. Templates provide a way to store this data more efficiently. The contractual product data which is duplicated on each contract can be extracted into a single template and replaced by a reference. This allows each trade to specify only the unique contractual product data. The template reference can be resolved to a template object which can then be merged in to form a single, complete object.</p>
<p>For instance, Equity Swaps used by Equity Financing desks sometimes refer to a <em>Master Confirmation</em> agreement, which is an overall agreement that specifies all the standard Equity Swap terms that do not need to be renegotiated on each trade. Each contractual product would only specify the unique product details (such as start and end date, underlier, price and spread) together with a reference to the Master Confirmation containing the template product details.</p>
<p>Code libraries, written in Java and distributed with the CDM, contain tools to merge CDM objects together.  Implementors may extend these merging tools to change the merging strategy to suit their requirements.  The CDM Java Examples download, available via the <a class="reference external" href="https://portal.cdm.rosetta-technology.io/#/downloads">CDM Portal Downloads page</a>, contains a example demonstrating usage of a data template and the merging tools. See <code class="docutils literal notranslate"><span class="pre">com.regnosys.cdm.example.template.TemplateExample</span></code>.</p>
</div>
</div>
<div class="section" id="products-with-identifiers">
<h3>Products with Identifiers<a class="headerlink" href="#products-with-identifiers" title="Permalink to this headline">¶</a></h3>
<p>The abstract data type ProductBase serves as a base for all products that have an identifier, as illustrated below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ProductBase:</span>
  <span class="n">productIdentifier</span> <span class="kt">ProductIdentifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<p>The data types that extend from ProductBase are Index, Commodity, Loan, and Security.  Index and Commodity do not have any additional attributes.  In the case of Commodity, the applicable product identifiers are the ISDA definitions for reference benchmarks.  Loan and Security both have a set of additional attributes, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Loan</span> <span class="n">extends</span> <span class="kt">ProductBase:</span>
  <span class="n">borrower</span> <span class="kt">LegalEntity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">lien</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">facilityType</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">creditAgreementDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">tranche</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Security</span> <span class="n">extends</span> <span class="kt">ProductBase:</span>
  <span class="n">securityType</span> <span class="kt">SecurityTypeEnum</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">debtType</span> <span class="kt">DebtType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">equityType</span> <span class="kt">EquityTypeEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">fundType</span> <span class="kt">FundProductTypeEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

<span class="nf">condition</span> <span class="kt">DebtSubType:</span>
  <span class="kr">if</span> <span class="n">securityType</span> <span class="o">&lt;&gt;</span> <span class="kt">SecurityTypeEnum</span> <span class="ow">-&gt;</span> <span class="kt">Debt</span>
  <span class="kr">then</span> <span class="n">debtType</span> <span class="n">is</span> <span class="n">absent</span>

<span class="nf">condition</span> <span class="kt">EquitySubType:</span>
  <span class="kr">if</span> <span class="n">securityType</span> <span class="o">&lt;&gt;</span> <span class="kt">SecurityTypeEnum</span> <span class="ow">-&gt;</span> <span class="kt">Equity</span>
  <span class="kr">then</span> <span class="n">equityType</span> <span class="n">is</span> <span class="n">absent</span>

<span class="nf">condition</span> <span class="kt">FundSubType:</span>
  <span class="kr">if</span> <span class="n">securityType</span> <span class="o">&lt;&gt;</span> <span class="kt">SecurityTypeEnum</span> <span class="ow">-&gt;</span> <span class="kt">Fund</span>
  <span class="kr">then</span> <span class="n">fundType</span> <span class="n">is</span> <span class="n">absent</span>
</pre></div>
</div>
<p>The product identifier will uniquely identify the security.  The <code class="docutils literal notranslate"><span class="pre">securityType</span></code> is required for specific purposes in the model, for example for validation as a valid reference obligation for a Credit Default Swap.  The additional security details are optional as these could be determined from a reference database using the product identifier as a key</p>
</div>
<div class="section" id="product-qualification">
<h3>Product Qualification<a class="headerlink" href="#product-qualification" title="Permalink to this headline">¶</a></h3>
<p><strong>Product qualification is inferred from the economic terms of the product</strong> instead of explicitly naming the product type.  The CDM uses a set of Product Qualification functions to achieve this purpose. These functions can be identified as those annotated with <code class="docutils literal notranslate"><span class="pre">[qualification</span> <span class="pre">Product]</span></code>.</p>
<p>A Product Qualification function applies a taxonomy-specific business logic to identify if the product attribute values, as represented by the product’s economic terms, match the specified criteria for the product named in that taxonomy. For example, if a certain set of attributes are populated and others are absent, then that specific product type is inferred. The Product Qualification function name in the CDM begins with the word <code class="docutils literal notranslate"><span class="pre">Qualify</span></code> followed by an underscore <code class="docutils literal notranslate"><span class="pre">_</span></code> and then the product type from the applicable taxonomy  (also separated by underscores).</p>
<p>The CDM implements the ISDA Product Taxonomy v2.0 to qualify contractual products, foreign exchange, and repurchase agreements. Given the prevalence of usage of the ISDA Product Taxonomy v1.0, the equivalent name from that taxonomy is also systematically indicated in the CDM, using a <code class="docutils literal notranslate"><span class="pre">synonym</span></code> annotation displayed under the function output. An example is provided below for the qualification of a Zero-Coupon Fixed-Float Inflation Swap:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">Qualify_InterestRate_InflationSwap_FixedFloat_ZeroCoupon:</span>
       <span class="p">[</span><span class="n">qualification</span> <span class="kt">Product</span><span class="p">]</span>
       <span class="n">inputs</span><span class="kt">:</span> <span class="n">economicTerms</span> <span class="kt">EconomicTerms</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span> <span class="n">is_product</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">is_product</span><span class="kt">:</span>
       <span class="p">(</span><span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="n">only</span> <span class="n">exists</span>
                       <span class="n">or</span> <span class="p">(</span><span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span><span class="p">,</span>  <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">cashflow</span><span class="p">)</span> <span class="n">only</span> <span class="n">exists</span><span class="p">)</span>
       <span class="n">and</span> <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="n">count</span> <span class="ow">=</span> <span class="mi">2</span>
       <span class="n">and</span> <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="ow">-&gt;</span> <span class="n">rateSpecification</span> <span class="ow">-&gt;</span> <span class="n">fixedRate</span> <span class="n">count</span> <span class="ow">=</span> <span class="mi">1</span>
       <span class="n">and</span> <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="ow">-&gt;</span> <span class="n">rateSpecification</span> <span class="ow">-&gt;</span> <span class="n">inflationRate</span> <span class="n">count</span> <span class="ow">=</span> <span class="mi">1</span>
       <span class="n">and</span> <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="ow">-&gt;</span> <span class="n">paymentDates</span> <span class="ow">-&gt;</span> <span class="n">paymentFrequency</span> <span class="ow">-&gt;</span> <span class="n">periodMultiplier</span> <span class="n">all</span> <span class="ow">=</span> <span class="mi">1</span>
       <span class="n">and</span> <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="ow">-&gt;</span> <span class="n">paymentDates</span> <span class="ow">-&gt;</span> <span class="n">paymentFrequency</span> <span class="ow">-&gt;</span> <span class="n">period</span> <span class="n">all</span> <span class="ow">=</span> <span class="kt">PeriodExtendedEnum</span> <span class="ow">-&gt;</span> <span class="kt">T</span>
</pre></div>
</div>
<p>If all the statements above are true, then the function evaluates to True, and the product is determined to be qualified as the product type referenced by the function name.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a typical CDM model implementation, the full set of Product Qualification functions would be invoked against each instance of the product in order to determine the inferred product type. Given the product model composability, a single product instance may be qualified as more than one type: for example in an Interest Rate Swaption, both the Option and the underlying Interest Rate Swap would be qualified.</p>
</div>
<p>The CDM supports Product Qualification functions for Credit Derivatives, Interest Rate Derivatives, Equity Derivatives, Foreign Exchange, and Repurchase Agreements. The full scope for Interest Rate Products has been represented down to the full level of detail in the taxonomy. This is shown in the example above, where the <code class="docutils literal notranslate"><span class="pre">ZeroCoupon</span></code> qualifying suffix is part of the function name. Credit Default products are qualified, but not down to the full level of detail. The ISDA Product Taxonomy v2.0 references the FpML <em>transaction type</em> field instead of just the product features, whose possible values are not publicly available and hence not positioned as a CDM enumeration.</p>
<p>The output of the qualification function is used to populate the <code class="docutils literal notranslate"><span class="pre">productQualifier</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">ProductIdentification</span></code> object, which is created when a <code class="docutils literal notranslate"><span class="pre">ContractualProduct</span></code> object is created. The product identification includes both the product qualification generated by the CDM and any additional product identification information which may come from the originating document, such as FpML. In this case, taxonomy schemes may be associated to such product identification information, which are also propagated in the <code class="docutils literal notranslate"><span class="pre">ProductIdentification</span></code> object.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">productIdentification</span></code> data structure and an instance of a CDM object (<a class="reference external" href="https://en.wikipedia.org/wiki/Serialization">serialised</a> into JSON) are shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ProductIdentification:</span>
       <span class="n">productQualifier</span> <span class="n">productType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">primaryAssetData</span> <span class="kt">AssetClassEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
       <span class="n">secondaryAssetData</span> <span class="kt">AssetClassEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
               <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
       <span class="n">externalProductType</span> <span class="kt">ExternalProductType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
       <span class="n">productIdentifier</span> <span class="kt">ProductIdentifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;productIdentification&quot;</span> <span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;externalProductType&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="s2">&quot;externalProductTypeSource&quot;</span> <span class="o">:</span> <span class="s2">&quot;FP_ML_PRODUCT_TYPE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;externalproductType&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;InterestRate:IRSwap:FixedFloat&quot;</span><span class="p">,</span>
      <span class="s2">&quot;meta&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;scheme&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.fpml.org/coding-scheme/product-taxonomy&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="p">],</span>
  <span class="s2">&quot;primaryAssetData&quot;</span> <span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;INTEREST_RATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meta&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;scheme&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.fpml.org/coding-scheme/asset-class-simple&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;productIdentifier&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="s2">&quot;identifier&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;InterestRate:IRSwap:FixedFloat&quot;</span><span class="p">,</span>
      <span class="s2">&quot;meta&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;scheme&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://www.fpml.org/coding-scheme/product-taxonomy&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;meta&quot;</span> <span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;globalKey&quot;</span> <span class="o">:</span> <span class="s2">&quot;98513226&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;source&quot;</span> <span class="o">:</span> <span class="s2">&quot;OTHER&quot;</span>
  <span class="p">}</span> <span class="p">],</span>
  <span class="s2">&quot;productQualifier&quot;</span> <span class="o">:</span> <span class="s2">&quot;InterestRate_IRSwap_FixedFloat_PlainVanilla&quot;</span><span class="p">,</span>
  <span class="s2">&quot;externalProductType&quot;</span> <span class="o">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span> <span class="o">:</span> <span class="s2">&quot;InterestRate:IRSwap:FixedFloat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;externalProductTypeSource&quot;</span> <span class="o">:</span> <span class="s2">&quot;FpMLProductType&quot;</span>

  <span class="p">}</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">productQualifier</span></code> is a <em>meta-type</em> that indicates that its value is meant to be populated via a function. This mechanism is explained in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#qualified-type">Qualified Type Section</a> of the Rosetta DSL documentation. For a further understanding of the underlying qualification logic in the Product Qualification, see the explanation of the <em>object qualification</em> feature of the Rosetta DSL, as described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#function-definition">Function Definition Section</a>.</p>
</div>
</div>
</div>
<div class="section" id="event-model">
<h2>Event Model<a class="headerlink" href="#event-model" title="Permalink to this headline">¶</a></h2>
<p><strong>The CDM event model provides data structures to represent the trade lifecycle events of financial transactions</strong>. A trade moves from one state to another as the result of <em>state transition</em> events initiated by one or both trading parties, by external factors or by contractual terms such as maturity. For example, the execution of the trade is the initial event which results in the state of an executed trade. Subsequently, one party might initiate an allocation, both parties might initiate an amendment to a contractual agreement, or a default by an underlying entity on a Credit Default Swap would trigger a settlement according to defined protection terms.</p>
<p>Examples of lifecycle events supported by the CDM Event Model include the following:</p>
<ul class="simple">
<li>Trade execution and confirmation</li>
<li>Clearing</li>
<li>Allocation</li>
<li>Settlement (including any future contingent cashflow payment)</li>
<li>Exercise of options</li>
</ul>
<p>The representation of state transitions in the CDM event model is based on the following design principles:</p>
<ul class="simple">
<li><strong>A lifecycle event describes a change in the state of a trade</strong>, i.e. there must be different before/after trade states based on that lifecycle event.</li>
<li><strong>The product definition that underlies the transaction remains immutable</strong>, unless agreed (negotiated) between the parties to that transaction as part of a specific trade lifecycle event. Automated events, for instance resets or cashflow payments, should not alter the product definition.</li>
<li><strong>The history of the trade state can be reconstructed at any point in the trade lifecycle</strong>, i.e. the CDM implements a <em>lineage</em> between states as the trade goes through state transitions.</li>
<li><strong>The state is trade-specific</strong>, not product-specific (i.e. it is not an asset-servicing model). The same product may be associated to infinitely many trades, each with its own specific state, between any two parties.</li>
</ul>
<p>The data structures in the event model are organised into four main sub-structures to represent state transitions, as described below.</p>
<div class="figure">
<img alt="_images/event-model-overview.png" src="_images/event-model-overview.png" />
</div>
<ul class="simple">
<li><strong>Trade state</strong> represents the state in the lifecycle that the trade is in, from execution to settlement and maturity.</li>
<li><strong>Primitive event</strong> is a building block component used to specify business events in the CDM. Each primitive event describes a fundamental state-transition component that impacts the trade state during its lifecycle.</li>
<li><strong>Business (i.e. trade lifecycle) event</strong> represents a lifecycle event, which may consist of one or more primitive events.</li>
<li><strong>Workflow</strong> represents a set of actions or steps that are required to trigger a business event.</li>
</ul>
<p>Each of these sub-structures are described in the subsequent sections.</p>
<div class="section" id="trade-state">
<h3>Trade State<a class="headerlink" href="#trade-state" title="Permalink to this headline">¶</a></h3>
<p>The trade state is defined in CDM by the <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> data type and represents the state of a trade at each stage in its lifecycle. With each trade creation or modification event, a new <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> instance is created. Chaining together the sequence of <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> instances then recreates the path each trade took within its lifecycle.</p>
<p><code class="docutils literal notranslate"><span class="pre">TradeState</span></code> is a foundational data type within the CDM Event Model as it represents the input and output of Primitive Events. Therefore, all trade related information that can change throughout the trade lifecycle are representing within <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">TradeState:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="p">[</span><span class="n">rootType</span><span class="p">]</span>
  <span class="n">trade</span> <span class="kt">Trade</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">state</span> <span class="kt">State</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">resetHistory</span> <span class="kt">Reset</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">transferHistory</span> <span class="kt">Transfer</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<p>While many different types of events may occur through the trade lifecycle, the <code class="docutils literal notranslate"><span class="pre">trade</span></code>, <code class="docutils literal notranslate"><span class="pre">state</span></code>, <code class="docutils literal notranslate"><span class="pre">resetHistory</span></code> and <code class="docutils literal notranslate"><span class="pre">transferHistory</span></code> attributes are deemed sufficient to describe all of the possible (post-trade) states which may result from lifecycle events. The <code class="docutils literal notranslate"><span class="pre">Trade</span></code> data type contains the tradable product, which defines all of the economic terms of the transaction as agreed between the parties.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A tradable product is represented by the <code class="docutils literal notranslate"><span class="pre">TradableProduct</span></code> data type, which is further detailed in the <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#tradable-product">Tradable Product Section</a> of the documentation.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Trade</span></code>, <code class="docutils literal notranslate"><span class="pre">State</span></code>, <code class="docutils literal notranslate"><span class="pre">Reset</span></code>, and <code class="docutils literal notranslate"><span class="pre">Transfer</span></code> data types that are utilised within <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>, are detailed in the sections below.</p>
<div class="section" id="trade">
<h4>Trade<a class="headerlink" href="#trade" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Trade</span></code> data type defines the outcome of a financial transaction between parties, where the terms are primarily reflected in the tradable product. Additionally, <code class="docutils literal notranslate"><span class="pre">Trade</span></code> includes attributes such as the trade date, transacting parties, and settlement terms. Some attributes, such as the parties, may already be defined in a workflow step or business event and can simply be referenced in <code class="docutils literal notranslate"><span class="pre">Trade</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Trade:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">tradeIdentifier</span> <span class="kt">Identifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">tradeDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">id</span><span class="p">]</span>
  <span class="n">tradableProduct</span> <span class="kt">TradableProduct</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">party</span> <span class="kt">Party</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">partyRole</span> <span class="kt">PartyRole</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">executionDetails</span> <span class="kt">ExecutionDetails</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">contractDetails</span> <span class="kt">ContractDetails</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">clearedDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">deprecated</span><span class="p">]</span>
  <span class="n">collateral</span> <span class="kt">Collateral</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">account</span> <span class="kt">Account</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">deprecated</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Attributes within <code class="docutils literal notranslate"><span class="pre">Trade</span></code> and <code class="docutils literal notranslate"><span class="pre">ContractDetails</span></code> incorporates elements from FpML’s <em>trade confirmation</em> view, whereas the <code class="docutils literal notranslate"><span class="pre">TradableProduct</span></code> data type corresponds to FpML’s <em>pre-trade</em> view.</p>
</div>
<p>Additionally, <code class="docutils literal notranslate"><span class="pre">Trade</span></code> supports representation of specific execution or contractual details via the <code class="docutils literal notranslate"><span class="pre">executionDetails</span></code> and <code class="docutils literal notranslate"><span class="pre">contractDetails</span></code> attributes.</p>
</div>
<div class="section" id="executiondetails-and-contractdetails">
<h4>ExecutionDetails and ContractDetails<a class="headerlink" href="#executiondetails-and-contractdetails" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">ExecutionDetails</span></code> data type represents details applicable to trade executions and includes attributes that describe the execution venue and execution type. Not all trades will have been ‘executed’, such as those created from a Swaption Exercise event. In those cases, the <code class="docutils literal notranslate"><span class="pre">executionDetails</span></code> attributes on <code class="docutils literal notranslate"><span class="pre">Trade</span></code> is expected to be empty.</p>
<p><code class="docutils literal notranslate"><span class="pre">ContractDetails</span></code> are only applicable to trades on contractual products and are typically provided at or prior to trade confirmation.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ContractDetails:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">documentation</span> <span class="kt">RelatedAgreement</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">governingLaw</span> <span class="kt">GoverningLawEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">partyContractInformation</span> <span class="kt">PartyContractInformation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="state">
<h4>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">State</span></code> data type defines the state of a trade at a point in the Trade’s life cycle. Trades have many state dimensions, all of which are represented here. For example, states useful for position keeping are represented alongside those needed for regulatory reporting.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">State:</span>
  <span class="n">closedState</span> <span class="kt">ClosedState</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">positionState</span> <span class="kt">PositionStatusEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><em>ClosedState</em>.</p>
<p>In the case when a trade is closed, it is necessary to record that closure as part of the trade state.</p>
<p>For instance in a full novation scenario, the initial state is a single <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> and the resulting state is two <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>. The first resulting <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> represents a new contract, which is the same as the original but where one of the parties has been changed, and the second resulting <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> is the original contract, now marked as <em>closed</em>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ClosedState</span></code> data type (enclosed within <code class="docutils literal notranslate"><span class="pre">State</span></code>) captures this closed state and defines the reason for closure.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">enum</span> <span class="kt">ClosedStateEnum:</span>
  <span class="kt">Allocated</span>
  <span class="kt">Cancelled</span>
  <span class="kt">Exercised</span>
  <span class="kt">Expired</span>
  <span class="kt">Matured</span>
  <span class="kt">Novated</span>
  <span class="kt">Terminated</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="primitive-event">
<h3>Primitive Event<a class="headerlink" href="#primitive-event" title="Permalink to this headline">¶</a></h3>
<p><strong>Primitive events are the building block components used to specify business events in the CDM</strong>. They describe the fundamental state-transition components that impact the trade state during its lifecycle. The trade state always transitions from and to a <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> data type.</p>
<p>The primitive events include <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> attributes, which can define the evolution of the trade state by taking the differences between <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> trade states.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">before</span></code> attribute is included as a reference using the <code class="docutils literal notranslate"><span class="pre">[metadata</span> <span class="pre">reference]</span></code> annotation, because by definition the primitive event points to a trade state that <em>already</em> existed. By contrast, the <code class="docutils literal notranslate"><span class="pre">after</span></code> trade state provides a full definition of that object, because that trade state is occurring for the first time and it is the occurrence of the primitive event that triggered a transition to that new trade state. By tying each trade state in the lifecycle to a previous trade state, primitive events are one of the mechanisms by which <em>lineage</em> is implemented in the CDM.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">PrimitiveEvent</span></code> can only include one of the primitive components, which is captured by the <code class="docutils literal notranslate"><span class="pre">one-of</span></code> condition. The list of primitive events can be seen in the <code class="docutils literal notranslate"><span class="pre">PrimitiveEvent</span></code> type definition:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">PrimitiveEvent:</span>
  <span class="n">execution</span> <span class="kt">ExecutionPrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">contractFormation</span> <span class="kt">ContractFormationPrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">split</span> <span class="kt">SplitPrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">quantityChange</span> <span class="kt">QuantityChangePrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">reset</span> <span class="kt">ResetPrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">termsChange</span> <span class="kt">TermsChangePrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">transfer</span> <span class="kt">TransferPrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">condition</span> <span class="kt">PrimitiveEvent:</span> <span class="n">one</span><span class="o">-</span><span class="kr">of</span>
</pre></div>
</div>
<p>Examples of how primitive components can be used are illustrated below.</p>
<div class="section" id="example-1-execution-and-contract-formation">
<h4>Example 1: Execution and Contract Formation<a class="headerlink" href="#example-1-execution-and-contract-formation" title="Permalink to this headline">¶</a></h4>
<p>Within the scope of the CDM, the first step in instantiating a transaction between two parties is an <em>execution</em> or a <em>contract formation</em>, which is an execution that has been confirmed between the executing parties. In some cases, there is a time delay between execution and confirmation, therefore the execution can be recorded as the first instantiation. In some other cases, the confirmation is nearly simultaneous with the execution, thus there is no need for an intermediate step.</p>
<p>The transition to an executed state prior to confirmation is represented by the <code class="docutils literal notranslate"><span class="pre">ExecutionPrimitive</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ExecutionPrimitive:</span>
  <span class="n">before</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">after</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The execution primitive does not allow any before state (as marked by the 0 cardinality of the <code class="docutils literal notranslate"><span class="pre">before</span></code> attribute) because the current CDM event model only covers post-trade lifecycle events. In practice, this execution state represents the conclusion of a pre-trade process, which may be a client order that gets filled or a quote that gets accepted by the client.</p>
<p>Following that execution, the trade is confirmed and a legally binding contract is signed between the two executing parties. In an allocation scenario, the trade would first get split into sub-accounts as designated by one of the executing parties, before a set of legally binding contracts is signed with each of those sub-accounts.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ContractFormationPrimitive</span></code> represents that transition to the trade state after the trade is confirmed, which results in a <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> containing a Trade object that can optionally reference legal documentation.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ContractFormationPrimitive:</span>
  <span class="n">before</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">after</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The before state in the contract formation primitive is optional (as marked by the 0 cardinality lower bound of the <code class="docutils literal notranslate"><span class="pre">before</span></code> attribute), to represent cases where a new contract may be instantiated between parties without any prior execution, for instance in a clearing or novation scenario.</p>
</div>
<div class="section" id="example-2-reset">
<h4>Example 2: Reset<a class="headerlink" href="#example-2-reset" title="Permalink to this headline">¶</a></h4>
<p>In many cases, a trade relies on observable values which will become known in the future: for instance, a floating rate observation at the beginning of each period in the case of a Interest Rate Swap, or the equity price at the end of each period in an Equity Swap. That primitive event is known as a <em>reset</em>.</p>
<p>When a observable value becomes known (as provided by the relevant market data provider), independently from any specific transaction, this information is captured by the <code class="docutils literal notranslate"><span class="pre">Observation</span></code> data type.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Observation:</span>
  <span class="p">[</span><span class="n">rootType</span><span class="p">]</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">observedValue</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">observationIdentifier</span> <span class="kt">ObservationIdentifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>From that <code class="docutils literal notranslate"><span class="pre">Observation</span></code>, a <code class="docutils literal notranslate"><span class="pre">Reset</span></code> can be built and included in <code class="docutils literal notranslate"><span class="pre">TradeState</span></code> without changing the <code class="docutils literal notranslate"><span class="pre">Trade</span></code>. A reset is represented by the <code class="docutils literal notranslate"><span class="pre">ResetPrimitive</span></code> data type.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">ResetPrimitive:</span>
  <span class="n">before</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">after</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">condition</span> <span class="kt">Trade:</span>
    <span class="n">before</span> <span class="ow">-&gt;</span> <span class="n">trade</span> <span class="ow">=</span> <span class="n">after</span> <span class="ow">-&gt;</span> <span class="n">trade</span>
</pre></div>
</div>
<p>The <em>reset</em> process creates instances of the <code class="docutils literal notranslate"><span class="pre">Reset</span></code> data type, which are added to <code class="docutils literal notranslate"><span class="pre">resetHistory</span></code> of a given <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Reset:</span>
  <span class="n">resetValue</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">resetDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">rateRecordDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">observations</span> <span class="kt">Observation</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">aggregationMethodology</span> <span class="kt">AggregationMethod</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">resetValue</span></code> attribute represents the ultimate value of the reset as a number and is the number used to compute corresponding cash flows. If multiple <code class="docutils literal notranslate"><span class="pre">observations</span></code> were used to derive the <code class="docutils literal notranslate"><span class="pre">resetValue</span></code>,  <code class="docutils literal notranslate"><span class="pre">aggregationMethod</span></code> should be used to describe how the many observations where aggregated into the single value.</p>
</div>
<div class="section" id="example-3-transfer">
<h4>Example 3: Transfer<a class="headerlink" href="#example-3-transfer" title="Permalink to this headline">¶</a></h4>
<p>A <code class="docutils literal notranslate"><span class="pre">TransferPrimitive</span></code> is a multi-purpose primitive that can represent the transfer of any asset, including cash, from one party to another.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">TransferPrimitive:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">before</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">after</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <em>transfer</em> process creates instances of the <code class="docutils literal notranslate"><span class="pre">Transfer</span></code> data type, which are added to <code class="docutils literal notranslate"><span class="pre">transferHistory</span></code> of a given <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Transfer:</span>
  <span class="n">identifier</span> <span class="kt">Identifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">quantity</span> <span class="kt">Quantity</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">observable</span> <span class="kt">Observable</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">payerReceiver</span> <span class="kt">PartyReferencePayerReceiver</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">settlementDate</span> <span class="kt">AdjustableOrAdjustedOrRelativeDate</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">settlementOrigin</span> <span class="kt">SettlementOrigin</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>By design, the CDM treats the reset and the transfer primitive events separately because there is no one-to-one relationship between reset and transfer.</p>
<ul class="simple">
<li>Many transfer events are not tied to any reset: for instance, the currency settlement from an FX spot or forward transaction.</li>
<li>Conversely, not all reset events generate a cashflow: for instance, the single, final settlement that is based on all the past floating rate resets in the case of a compounding floating zero-coupon swap.</li>
</ul>
</div>
</div>
<div class="section" id="business-event">
<h3>Business Event<a class="headerlink" href="#business-event" title="Permalink to this headline">¶</a></h3>
<p>A Business Event represents a transaction lifecycle event and is built according to the following design principle in the CDM:</p>
<ul class="simple">
<li><strong>Business events are specified by composition of primitive events</strong>, which describe the fundamental state-transition components that may impact the trade state during its lifecycle.</li>
<li><strong>Business event qualification is inferred from those primitive event components</strong> and, in some relevant cases, from an <em>intent</em> qualifier associated with the business event. The inferred value is populated in the <code class="docutils literal notranslate"><span class="pre">eventQualifier</span></code> attribute.</li>
</ul>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">BusinessEvent:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="p">[</span><span class="n">rootType</span><span class="p">]</span>
  <span class="n">primitives</span> <span class="kt">PrimitiveEvent</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">intent</span> <span class="kt">IntentEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">functionCall</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">eventQualifier</span> <span class="n">eventType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">eventDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">effectiveDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">eventEffect</span> <span class="kt">EventEffect</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">workflowEventState</span> <span class="kt">WorkflowStepState</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">[</span><span class="n">deprecated</span><span class="p">]</span>
</pre></div>
</div>
<p>As can be observed in the definition above, the only mandatory attributes of a business event are the ones listed below:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">primitives</span></code> attribute, which contains the list of one or more primitive events composing that business event, each representing one and only one fundamental state-transition.</li>
<li>The event date. The time dimension has been purposely ommitted from the event’s attributes. That is because, while a business event has a unique date, several time stamps may potentially be associated to that event depending on when it was submitted, accepted, rejected etc, all of which are <em>workflow</em> considerations.</li>
</ul>
<p>An example composition of the primitive events to represent a complete lifecycle event is the <em>partial novation</em> of a contract, which comprises the following:</p>
<ul class="simple">
<li>a <code class="docutils literal notranslate"><span class="pre">ContractFormation</span></code> primitive that represents the contract between the remaining party and the step in novation party. The <code class="docutils literal notranslate"><span class="pre">tradeDate</span></code> in the <code class="docutils literal notranslate"><span class="pre">ContractFormation</span></code> primitive should reflect the date of that the novation event was agreed.</li>
<li>a <code class="docutils literal notranslate"><span class="pre">QuantityChange</span></code> primitive which includes a before attribute that defines the terms of the trade between the original parties before the novation and an after attribute the defines the terms of the trade between the original parties after the novation, in which the quantity should be less than the quantity in the before state and greater than 0 (0 would represent the case of a <em>full novation</em>).</li>
</ul>
<p>A business event is <em>atomic</em> in the sense that its underlying primitive event constituents cannot happen independently: they either all happen together or they do not happen. In the above partial novation example, the existing trade between the parties must be downsized at the same time as the new trade is instantiated.</p>
<p>Selected attributes of a business event are further explained below:</p>
<div class="section" id="intent">
<h4>Intent<a class="headerlink" href="#intent" title="Permalink to this headline">¶</a></h4>
<p>The Intent attribute is an enumeration value that represents the intent of a particular business event, e.g. <code class="docutils literal notranslate"><span class="pre">Allocation</span></code>, <code class="docutils literal notranslate"><span class="pre">EarlyTermination</span></code>, <code class="docutils literal notranslate"><span class="pre">PartialTermination</span></code> etc. It is used in cases where the primitive events are not sufficient to uniquely inferr a lifecycle event. As an example, a reduction in a trade quantity/notional could apply to a correction event or a partial termination.</p>
</div>
<div class="section" id="event-effect">
<h4>Event Effect<a class="headerlink" href="#event-effect" title="Permalink to this headline">¶</a></h4>
<p>The event effect attribute corresponds to the set of operational and positional effects associated with a lifecycle event. This information is generated by a post-processor associated to the CDM. Certain events such as observations do not have any event effect, hence the optional cardinality.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">eventEffect</span></code> contains a set of pointers to the relevant objects that are affected by the event and annotated with <code class="docutils literal notranslate"><span class="pre">[metadata</span> <span class="pre">reference]</span></code>. The candidate objects are types that are marked as referenceable via an associated <code class="docutils literal notranslate"><span class="pre">[metadata</span> <span class="pre">key]</span></code> annotation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The use of the key/reference mechanism is further described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#meta-data-and-reference">Meta-Data Section</a> of the Rosetta DSL documentation.</p>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">EventEffect:</span>
  <span class="n">effectedTrade</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">trade</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">productIdentifier</span> <span class="kt">ProductIdentifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">transfer</span> <span class="kt">TransferPrimitive</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
</pre></div>
</div>
<p>The JSON snippet below for a quantity change event on a trade illustrates the use of multiple metadata reference values in <code class="docutils literal notranslate"><span class="pre">eventEffect</span></code>.</p>
<div class="highlight-Javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;effectiveDate&quot;</span><span class="o">:</span> <span class="s2">&quot;2018-03-15&quot;</span><span class="p">,</span>
<span class="s2">&quot;eventDate&quot;</span><span class="o">:</span> <span class="s2">&quot;2018-03-14&quot;</span><span class="p">,</span>
<span class="s2">&quot;eventEffect&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;trade&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;globalReference&quot;</span><span class="o">:</span> <span class="s2">&quot;600e4873&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;effectedTrade&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;globalReference&quot;</span><span class="o">:</span> <span class="s2">&quot;d36e1d72&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">},</span>
<span class="p">(...)</span>
<span class="s2">&quot;primitive&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;quantityChange&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">(...)</span>
        <span class="s2">&quot;meta&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;globalKey&quot;</span><span class="o">:</span> <span class="s2">&quot;600e4873&quot;</span>
        <span class="p">}</span>
        <span class="s2">&quot;trade&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="p">(...)</span>
          <span class="s2">&quot;tradeDate&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;2002-12-04&quot;</span><span class="p">,</span>
            <span class="s2">&quot;meta&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;globalKey&quot;</span><span class="o">:</span> <span class="s2">&quot;793cd7c&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;before&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">(...)</span>
        <span class="s2">&quot;meta&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;globalKey&quot;</span><span class="o">:</span> <span class="s2">&quot;d36e1d72&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;trade&quot;</span><span class="o">:</span> <span class="p">{</span>
          <span class="p">(...)</span>
          <span class="s2">&quot;tradeDate&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;date&quot;</span><span class="o">:</span> <span class="s2">&quot;2002-12-04&quot;</span><span class="p">,</span>
            <span class="s2">&quot;meta&quot;</span><span class="o">:</span> <span class="p">{</span>
              <span class="s2">&quot;globalKey&quot;</span><span class="o">:</span> <span class="s2">&quot;793cd7c&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>For the <code class="docutils literal notranslate"><span class="pre">effectedTrade</span></code>: <code class="docutils literal notranslate"><span class="pre">d36e1d72</span></code> points to the original trade in the <code class="docutils literal notranslate"><span class="pre">before</span></code> state of the <code class="docutils literal notranslate"><span class="pre">quantityChange</span></code> primitive event.</li>
<li>For the <code class="docutils literal notranslate"><span class="pre">trade</span></code>: <code class="docutils literal notranslate"><span class="pre">600e4873</span></code> points to the new trade in the <code class="docutils literal notranslate"><span class="pre">after</span></code> state of the <code class="docutils literal notranslate"><span class="pre">quantityChange</span></code> primitive event. Note how the new contract retains the initial <code class="docutils literal notranslate"><span class="pre">tradeDate</span></code> attribute of the original trade even after a quantity change.</li>
</ul>
</div>
<div class="section" id="other-misc-information">
<h4>Other Misc. Information<a class="headerlink" href="#other-misc-information" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>The effective date is optional as it is not applicable to certain events (e.g. observations), or may be redundant with the event date.</li>
<li>The event qualifier attribute is derived from the event qualification features. This is further detailed in the <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#event-qualification">Event Qualification Section</a>.</li>
</ul>
</div>
</div>
<div class="section" id="workflow">
<h3>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h3>
<p>The CDM provides support for implementors to develop workflows to process transaction lifecycle events and provides attributes to define lineage from one workflow step to another.</p>
<p>A <em>workflow</em> represents a set of actions or steps that are required to trigger a business event, including the initial execution or contract formation. A workflow is organised into a sequence in which each step is represented by a <em>workflow step</em>. A workflow may involve multiple parties in addition to the parties to the transaction, and may include automated and manual steps. A workflow may involve only one step.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">WorkflowStep:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="p">[</span><span class="n">rootType</span><span class="p">]</span>
  <span class="n">businessEvent</span> <span class="kt">BusinessEvent</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">proposedInstruction</span> <span class="kt">Instruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">rejected</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">previousWorkflowStep</span> <span class="kt">WorkflowStep</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">messageInformation</span> <span class="kt">MessageInformation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">timestamp</span> <span class="kt">EventTimestamp</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">eventIdentifier</span> <span class="kt">Identifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">action</span> <span class="kt">ActionEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">party</span> <span class="kt">Party</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">account</span> <span class="kt">Account</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">lineage</span> <span class="kt">Lineage</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The different attributes of a workflow step are detailed in the sections below.</p>
<div class="section" id="id1">
<h4>Business Event<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>This attribute specifies the business event that the workflow step is meant to generate. It is optional because the workflow may require a number of interim steps before the state-transition embedded within the business event becomes effective, therefore the business event does not exist yet in those steps. The business event attribute is typically associated with the final step in the workflow.</p>
</div>
<div class="section" id="proposed-instruction">
<h4>Proposed Instruction<a class="headerlink" href="#proposed-instruction" title="Permalink to this headline">¶</a></h4>
<p>This attribute allows for the specification of inputs that when combined with the current trade state, are referenced to generate the state-transition. For example, allocation instructions describe how to divide the initial block trade into smaller pieces, each of which is assigned to a specific party representing a legal entity related to the executing party.  It is optional because it is not required for all workflow steps.  Validation components are in place to check that the <code class="docutils literal notranslate"><span class="pre">businessEvent</span></code> and <code class="docutils literal notranslate"><span class="pre">proposedInstruction</span></code> attributes are mutually exclusive.</p>
<p>The list of business events for which this process is currently implemented in the CDM is reflected in the structure of the <code class="docutils literal notranslate"><span class="pre">Instruction</span></code> data type:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Instruction:</span>
  <span class="n">instructionFunction</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">allocation</span> <span class="kt">AllocationInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">clearing</span> <span class="kt">ClearingInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">contractFormation</span> <span class="kt">ContractFormationInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">execution</span> <span class="kt">ExecutionInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">exercise</span> <span class="kt">ExerciseInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">reset</span> <span class="kt">ResetInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">transfer</span> <span class="kt">TransferInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">increase</span> <span class="kt">IncreaseInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">decrease</span> <span class="kt">DecreaseInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">indexTransition</span> <span class="kt">IndexTransitionInstruction</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">condition</span> <span class="kt">OneOfInstruction:</span> <span class="n">required</span> <span class="n">choice</span> <span class="n">allocation</span><span class="p">,</span> <span class="n">clearing</span><span class="p">,</span> <span class="n">contractFormation</span><span class="p">,</span> <span class="n">execution</span><span class="p">,</span> <span class="n">exercise</span><span class="p">,</span> <span class="n">reset</span><span class="p">,</span> <span class="n">transfer</span><span class="p">,</span> <span class="n">indexTransition</span><span class="p">,</span> <span class="n">increase</span><span class="p">,</span> <span class="n">decrease</span>
</pre></div>
</div>
</div>
<div class="section" id="previous-workflow-step">
<h4>Previous Workflow Step<a class="headerlink" href="#previous-workflow-step" title="Permalink to this headline">¶</a></h4>
<p>This attribute, which is provided as a reference, defines the lineage between steps in a workflow. The result is an audit trail for a business event, which can trace the various steps leading to the business event that was triggered.</p>
</div>
<div class="section" id="action">
<h4>Action<a class="headerlink" href="#action" title="Permalink to this headline">¶</a></h4>
<p>The action enumeration qualification specifies whether the event is a new one or a correction or cancellation of a prior one, which are trade entry references and not reflective of negotiated changes to a contract.</p>
</div>
<div class="section" id="message-information">
<h4>Message Information<a class="headerlink" href="#message-information" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">messageInformation</span></code> attribute defines details for delivery of the message containing the workflow steps.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">MessageInformation:</span>
  <span class="n">messageId</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">sentBy</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">sentTo</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">copyTo</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sentBy</span></code>, <code class="docutils literal notranslate"><span class="pre">sentTo</span></code> and <code class="docutils literal notranslate"><span class="pre">copyTo</span></code> information is optional, as possibly not applicable in a all technology contexts (e.g. in case of a distributed architecture).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">MessageInformation corresponds to some of the components of the FpML <em>MessageHeader.model</em>.</p>
</div>
</div>
<div class="section" id="timestamp">
<h4>Timestamp<a class="headerlink" href="#timestamp" title="Permalink to this headline">¶</a></h4>
<p>The CDM adopts a generic approach to represent timestamp information, consisting of a <code class="docutils literal notranslate"><span class="pre">dateTime</span></code> and a <code class="docutils literal notranslate"><span class="pre">qualification</span></code> attributes, with the latter specified through an enumeration value.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">EventTimestamp:</span>
  <span class="n">dateTime</span> <span class="n">zonedDateTime</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">qualification</span> <span class="kt">EventTimestampQualificationEnum</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The benefits of the CDM generic approach are twofold:</p>
<ul class="simple">
<li>It allows for flexibility in a context where it would be challenging to mandate which points in the process should have associated timestamps.</li>
<li>Gathering all of those in one place in the model allows for evaluation and rationalisation down the road.</li>
</ul>
<p>Below is an instance of a CDM representation (<a class="reference external" href="https://en.wikipedia.org/wiki/Serialization">serialised</a> into JSON) of this approach.</p>
<div class="highlight-Javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;timestamp&quot;</span><span class="o">:</span> <span class="p">[</span>
 <span class="p">{</span>
    <span class="s2">&quot;dateTime&quot;</span><span class="o">:</span> <span class="s2">&quot;2007-10-31T18:08:40.335-05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qualification&quot;</span><span class="o">:</span> <span class="s2">&quot;EVENT_SUBMITTED&quot;</span>
 <span class="p">},</span>
 <span class="p">{</span>
    <span class="s2">&quot;dateTime&quot;</span><span class="o">:</span> <span class="s2">&quot;2007-10-31T18:08:40.335-05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;qualification&quot;</span><span class="o">:</span> <span class="s2">&quot;EVENT_CREATED&quot;</span>
 <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="event-identifier">
<h4>Event Identifier<a class="headerlink" href="#event-identifier" title="Permalink to this headline">¶</a></h4>
<p>The Event Identifier provides a unique id that can be used for reference by other workflow steps. The data type is a generic identifier component that is used throughout the product and event models. The event identifier information comprises the <code class="docutils literal notranslate"><span class="pre">assignedIdentifier</span></code> and an <code class="docutils literal notranslate"><span class="pre">issuer</span></code>, which may be provided as a reference or via a scheme.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Identifier:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">issuerReference</span> <span class="kt">Party</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">issuer</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">assignedIdentifier</span> <span class="kt">AssignedIdentifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>

  <span class="n">condition</span> <span class="kt">IssuerChoice:</span>
    <span class="n">required</span> <span class="n">choice</span> <span class="n">issuerReference</span><span class="p">,</span> <span class="n">issuer</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">FpML also uses an event identifier construct: the <code class="docutils literal notranslate"><span class="pre">CorrelationId</span></code>, but it is distinct from the identifier associated with the trade itself, which comes in different variations: <code class="docutils literal notranslate"><span class="pre">PartyTradeIdentifier</span></code>, with the <code class="docutils literal notranslate"><span class="pre">TradeId</span></code> and the <code class="docutils literal notranslate"><span class="pre">VersionedTradeId</span></code> as sub-components).</p>
</div>
</div>
<div class="section" id="other-misc-attributes">
<h4>Other Misc. Attributes<a class="headerlink" href="#other-misc-attributes" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">party</span></code> and <code class="docutils literal notranslate"><span class="pre">account</span></code> information are optional because not applicable to certain events.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">lineage</span></code> attribute was previously used to reference an unbounded set of contracts, events and/or payout components, that an event may be associated to.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">lineage</span></code> attribute is superseded by the implementation in the CDM of: (i) trade state lineage, via the <code class="docutils literal notranslate"><span class="pre">before</span></code> / <code class="docutils literal notranslate"><span class="pre">after</span></code> attributes in the primitive event component, and (ii) workflow lineage, via the <code class="docutils literal notranslate"><span class="pre">previousWorkflowStep</span></code> attribute.</p>
</div>
</div>
</div>
<div class="section" id="event-qualification">
<h3>Event Qualification<a class="headerlink" href="#event-qualification" title="Permalink to this headline">¶</a></h3>
<p><strong>The CDM qualifies lifecycle events as a function of their primitive event components</strong> rather than explicitly naming the event type. The CDM uses the same approach for event qualification as for product qualification, which is based on a set of Event Qualification functions. These functions can be identified as those annotated with <code class="docutils literal notranslate"><span class="pre">[qualification</span> <span class="pre">BusinessEvent]</span></code>.</p>
<p>Event Qualification functions apply a taxonomy-specific business logic to identify if the state-transition attributes values, which are embedded in the primitive event components, match the specified criteria for the event named in that taxonomy. Like Product Qualification functions, the Event Qualification function name begins with the word <code class="docutils literal notranslate"><span class="pre">Qualify</span></code> followed by an underscore <code class="docutils literal notranslate"><span class="pre">_</span></code> and then the taxonomy name.</p>
<p>The CDM uses the ISDA taxonomy V2.0 leaf level to qualify the event. 22 lifecycle events have currently been qualified as part of the CDM.</p>
<p>One distinction with the product approach is that the <code class="docutils literal notranslate"><span class="pre">intent</span></code> qualification is also deemed necessary to complement the primitive event information in certain cases. To this effect, the Event Qualification function allows to specify that when present, the intent must have a specified value, as illustrated by the below example.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">Qualify_Termination:</span>
       <span class="p">[</span><span class="n">qualification</span> <span class="kt">BusinessEvent</span><span class="p">]</span>
       <span class="n">inputs</span><span class="kt">:</span>
               <span class="n">businessEvent</span> <span class="kt">BusinessEvent</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span> <span class="n">is_event</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">alias</span> <span class="n">transfer</span><span class="kt">:</span> <span class="kt">TransfersForDate</span><span class="p">(</span> <span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">primitives</span> <span class="ow">-&gt;</span> <span class="n">transfer</span> <span class="ow">-&gt;</span> <span class="n">after</span> <span class="ow">-&gt;</span> <span class="n">transferHistory</span><span class="p">,</span> <span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">eventDate</span> <span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">transfers</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span>
       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">is_event</span><span class="kt">:</span>
               <span class="p">(</span><span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">intent</span> <span class="n">is</span> <span class="n">absent</span> <span class="n">or</span> <span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">intent</span> <span class="ow">=</span> <span class="kt">IntentEnum</span> <span class="ow">-&gt;</span> <span class="kt">Termination</span><span class="p">)</span>
               <span class="n">and</span> <span class="p">((</span><span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">primitives</span> <span class="n">count</span> <span class="ow">=</span> <span class="mi">1</span> <span class="n">and</span> <span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">primitives</span> <span class="ow">-&gt;</span> <span class="n">quantityChange</span> <span class="n">exists</span><span class="p">)</span>
                       <span class="n">or</span> <span class="p">(</span><span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">primitives</span> <span class="ow">-&gt;</span> <span class="n">quantityChange</span> <span class="n">exists</span> <span class="n">and</span> <span class="n">transfer</span> <span class="n">exists</span><span class="p">))</span>
               <span class="n">and</span> <span class="kt">QuantityDecreasedToZero</span><span class="p">(</span><span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">primitives</span> <span class="ow">-&gt;</span> <span class="n">quantityChange</span><span class="p">)</span> <span class="ow">=</span> <span class="kt">True</span>
               <span class="n">and</span> <span class="n">businessEvent</span> <span class="ow">-&gt;</span> <span class="n">primitives</span> <span class="ow">-&gt;</span> <span class="n">quantityChange</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span> <span class="ow">-&gt;</span> <span class="n">after</span> <span class="ow">-&gt;</span> <span class="n">state</span> <span class="ow">-&gt;</span> <span class="n">closedState</span> <span class="ow">-&gt;</span> <span class="n">state</span> <span class="ow">=</span> <span class="kt">ClosedStateEnum</span> <span class="ow">-&gt;</span> <span class="kt">Terminated</span>
</pre></div>
</div>
<p>If all the statements above are true, then the function evaluates to True. In this case, the event is determined to be qualified as the event type referenced by the function name.</p>
<p>The output of the qualification function is used to populate the <code class="docutils literal notranslate"><span class="pre">eventQualifier</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">BusinessEvent</span></code> object, similar to how product qualification works. An implementation of the CDM would call all of the Event Qualification functions following the creation of each event and then insert the appropriate value or provide an exception message.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">eventType</span></code> is a <em>meta-type</em> that indicates that its value is meant to be populated via a function. This mechanism is explained in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#qualified-type">Qualified Type Section</a> of the Rosetta DSL documentation. For a further understanding of the underlying qualification logic in the Product Qualification, see the explanation of the <em>object qualification</em> feature of the Rosetta DSL, as described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#function-definition">Function Definition Section</a>.</p>
</div>
</div>
</div>
<div class="section" id="legal-agreements">
<h2>Legal Agreements<a class="headerlink" href="#legal-agreements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-use-of-agreements-in-financial-markets">
<h3>The Use of <em>Agreements</em> in Financial Markets<a class="headerlink" href="#the-use-of-agreements-in-financial-markets" title="Permalink to this headline">¶</a></h3>
<p>Financial transactions consist primarily of agreements between parties to make future payments or deliveries to each other. To ensure performance, those agreements typically take the form of legally enforceable contracts, which the parties record in writing to minimize potential future disagreements.</p>
<p>It is common practice in some markets for different aspects of these agreements to be recorded in different documents, most commonly dividing those terms that exist at the trading relationship level (e.g. credit risk monitoring and collateral) from those at the transaction level (the economic and risk terms of individual transactions). Relationship agreements and individual transaction level documents are often called “master agreements” and “confirmations” respectively, and multiple confirmations may be linked to a single master agreement.</p>
<p>Both the relationship and transaction level documents may be further divided into those parts that are standard for the relevant market, which may exist in a pre-defined base form published by a trade association or similar body, and those that are more bespoke and agreed by the specific parties. The standard published forms may anticipate that the parties will choose from pre-defined elections in a published form, or create their own bespoke amendments.</p>
<p>The ISDA Master Agreement is an internationally recognised document which is used to provide certain legal and credit protection for parties who enter into OTC derivatives. Parties that execute agreements for OTC derivatives are expected to have bi-lateral Master Agreements with each other that cover an agreed range of transactions. Accordingly in the CDM each transaction can be associated with a single master agreement, and a single master agreement can be associated with multiple transactions.</p>
<p>In addition to the Master Agreement are sets of credit support documentation which parties may enter into as part of Master Agreement to contain the terms on which they will exchange collateral for their OTC derivatives. Collateral provides protection to a party against the risk that its counterparty defaults and fails to pay the amount that it owes on default. The risk of loss in this scenario is for the current cost of replacing the defaulted transactions (for which margin is called “variation margin”) and the risk of further loss before the default can be closed out (called “initial margin” or “independent amount”).</p>
<p>There are several different types of ISDA credit support document, reflecting variation and initial margin, regulatory requirements and terms for legal relationships under different legal jurisdictions. The key components of the suite of credit support documents are summarized below:</p>
<ul class="simple">
<li><strong>Credit Support Annexes (CSAs)</strong> exist in New York, English, Irish, French, and Japanese law forms.  They define the terms for the provision of collateral by the parties in derivatives transactions, and in some cases they are specialized for initial margin or variation margin.</li>
<li><strong>Credit Support Deed CSD (CSD)</strong> is very similar to a CSA, except that it is used to create specific types of legal rights over the collateral under English and Irish law, which requires a specific type of legal agreement (a deed).</li>
<li><strong>The Collateral Transfer Agreement and Security Agreement (CTA and SA)</strong> together define a collateral arrangement where initial margin is posted to a custodian account for use in complying with initial margin requirements. The CTA/SA offers additional flexibility by allowing parties to apply one governing law to the mechanical aspects of the collateral relationship (the CTA) and a different governing law to the grant and enforcement of security over the custodian account (the SA).</li>
</ul>
<p>In the CDM and in this user documentation, <em>legal agreement</em> refers to the written terms of a relationship-level agreement, and <em>contract</em> refers to the written terms defining an executed financial transaction.</p>
</div>
<div class="section" id="legal-agreements-in-the-cdm">
<h3>Legal Agreements in the CDM<a class="headerlink" href="#legal-agreements-in-the-cdm" title="Permalink to this headline">¶</a></h3>
<p>The CDM provides a digital representation of the legal agreements that govern transactions and workflows. The benefits of this digital representation are summarized below:</p>
<ul class="simple">
<li><strong>Supporting marketplace initiatives to streamline and standardise legal agreements</strong> with a comprehensive digital representation of such agreements.</li>
<li><strong>Providing a comprehensive representation of the financial workflows</strong> by complementing the trade and lifecycle event model and formally tying legal data to the business outcome and performance of legal clauses. (e.g. in collateral management where lifecycle processes require reference to parameters found in the associated legal agreements, such as the Credit Support Annex).</li>
<li><strong>Supporting the direct implementation of functional processes</strong> by providing a normalised representation of legal agreements as structured data, as opposed to the unstructured data contained of a full legal text that needs to be interpreted first before any implementation (e.g. for a calculation of an amount specified in a legal definition).</li>
</ul>
<p>The scope of the CDM legal agreement model includes all of the types of ISDA credit support documents. The legal agreement model is explained below, including examples and references to these types of documents.</p>
<p>The topics covered in this section are listed below:</p>
<ul class="simple">
<li>Modelling Approach</li>
<li>Legal Agreement Data Structure</li>
<li>Linking Legal Agreements to contracts</li>
</ul>
</div>
<div class="section" id="modelling-approach">
<h3>Modelling Approach<a class="headerlink" href="#modelling-approach" title="Permalink to this headline">¶</a></h3>
<div class="section" id="scope">
<h4>Scope<a class="headerlink" href="#scope" title="Permalink to this headline">¶</a></h4>
<p>The legal agreement model in the CDM comprises the following features:</p>
<ul>
<li><p class="first"><strong>Composable and normalised model representation</strong> of the ISDA agreements. The terms of an ISDA agreement can be defined by identification of the published base document, and the elections or amendments made to that base in a specific legal agreement. There are distinct versions of the published agreements for jurisdiction and year of publication, but the set of elections and amendments to those base agreements often belong to a common universe. Therefore, the CDM defines each of these terms in a single location, and allows for the representation of a specific legal agreement by combining terms where appropriate. The following legal agreements are supported in the CDM:</p>
<p><strong>Initial Margin Agreements</strong></p>
<ul class="simple">
<li>ISDA 2016 Phase One Credit Support Annex (“CSA”) (Security Interest – New York Law)</li>
<li>ISDA 2016 Phase One Credit Support Deed (“CSD”) (Security Interest – English Law)</li>
<li>ISDA 2016 Phase One CSA (Loan – Japanese Law)</li>
<li>ISDA 2016 ISDA-Clearstream Collateral Transfer Agreement (“CTA”) (New York law and Multi Regime English Law) and Security Agreement</li>
<li>ISDA 2016 ISDA-Euroclear CTA (New York law and Multi Regime English Law) and Security Agreement</li>
<li>ISDA 2018 CSA (Security Interest – New York Law)</li>
<li>ISDA 2018 CSD (Security Interest – English Law)</li>
<li>ISDA 2019 Bank Custodian CTA and Security Agreement (English Law, New York Law)</li>
<li>ISDA 2019 ISDA-Clearstream CTA and Security Agreement (Luxembourg Law – Security-provider or Security-taker name)</li>
<li>ISDA 2019 ISDA-Euroclear CTA and Security Agreement</li>
</ul>
<p><strong>Variation Margin Agreements</strong></p>
<ul class="simple">
<li>ISDA 2016 CSA for Variation Margin (“VM”) (Security Interest - New York Law)</li>
<li>ISDA 2016 CSA for VM (Title Transfer – English Law)</li>
<li>ISDA 2016 CSA for VM (Loan – Japanese Law)</li>
<li>ISDA 2016 CSA for VM (Title Transfer – Irish Law)</li>
<li>ISDA 2016 CSA for VM (Title Transfer – French Law)</li>
</ul>
<p><strong>Master Agreement Schedule</strong></p>
<ul class="simple">
<li>ISDA 2002 Master Agreement Schedule (Partial agreement representation)</li>
</ul>
</li>
<li><p class="first"><strong>Composable and normalised model representation</strong> of the eligible collateral schedule for initial and variation margin into a directly machine readable format.</p>
</li>
<li><p class="first"><strong>Linking of legal agreement into a trade object</strong> through the CDM referencing mechanism.</p>
</li>
<li><p class="first"><strong>Mapping to ISDA Create derivative documentation negotiation platform</strong> : Synonyms identified as belonging to <code class="docutils literal notranslate"><span class="pre">ISDA_Create_1_0</span></code> have been defined to establish mappings that support automated transformation of ISDA Create documents into objects that are compliant with the CDM.</p>
<ul class="simple">
<li>The mapping between the two models through the use of Synonyms validated that all the necessary permutations of elections and data associated with the supported agreements have been replicated in the CDM</li>
<li>Ingestion of JSON sample files generated from ISDA Create for samples of executed documents has been implemented in the ISDA CDM Portal to demonstrate this capability between ISDA Create and the CDM.</li>
<li>More details on Synonyms are provided in the Mapping (Synonym) section of this document.</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The CDM supports the ISDA CSA for Variation Margin, but this document is not yet represented in ISDA Create - the CDM representation of this document is tested with alternative external sample data.</p>
</div>
</div>
<div class="section" id="design-principles">
<h4>Design Principles<a class="headerlink" href="#design-principles" title="Permalink to this headline">¶</a></h4>
<p>The key modelling principles that have been adopted to represent legal agreements are described below:</p>
<ul class="simple">
<li><strong>Distinction between the agreement identification features and the agreement content features</strong><ul>
<li>The agreement identification features: agreement name, publisher (of the base agreement being used), identification, etc. are represented by the <code class="docutils literal notranslate"><span class="pre">LegalAgreementBase</span></code> type.</li>
<li>The agreement content features: elections and amendments to the published agreement, related agreements and umbrella agreement terms are represented by the <code class="docutils literal notranslate"><span class="pre">AgreementTerms</span></code>.</li>
</ul>
</li>
<li><strong>Composite and extendable model</strong>.<ul>
<li>The Legal Agreement model follows the CDM design principles of composability and reusability to develop an extendable model that can support multiple document types.</li>
<li>For instance, the <code class="docutils literal notranslate"><span class="pre">LegalAgreementBase</span></code> data type uses components that are also used as part of the CDM trade and lifecycle event components: e.g. <code class="docutils literal notranslate"><span class="pre">Party</span></code>, <code class="docutils literal notranslate"><span class="pre">Identifier</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>.</li>
</ul>
</li>
<li><strong>Normalisation of the data representation</strong><ul>
<li>Strong data type attributes such as numbers, Boolean, or enumerations are used where possible to create a series of normalised elections within terms used in ISDA documentation and create a data representation of the legal agreement that is machine readable and executable. This approach allows CDM users to define normalised elections into a corresponding legal agreement template to support functional processes.</li>
<li>In practice the use of elections expressed in a <code class="docutils literal notranslate"><span class="pre">string</span></code> format has been restricted, as the <code class="docutils literal notranslate"><span class="pre">string</span></code> format is generally unsuitable for the support of standardised functional processes.</li>
</ul>
</li>
</ul>
<p>The components of the legal agreement model specified in the CDM are detailed in the section below.</p>
</div>
</div>
<div class="section" id="legal-agreement-data-structure">
<h3>Legal Agreement Data Structure<a class="headerlink" href="#legal-agreement-data-structure" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">LegalAgreement</span></code> data type represents the highest-level data type for defining a legal agreement in the CDM.  This data type extends the <code class="docutils literal notranslate"><span class="pre">LegalAgreementBase</span></code>, which contains information to uniquely identify an agreement. There are three non-inherited components to <code class="docutils literal notranslate"><span class="pre">LegalAgreement</span></code>, as shown in the code snippet below:.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">LegalAgreement</span> <span class="n">extends</span> <span class="kt">LegalAgreementBase:</span>
      <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
      <span class="p">[</span><span class="n">rootType</span><span class="p">]</span>
  <span class="n">agreementTerms</span> <span class="kt">AgreementTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">relatedAgreements</span> <span class="kt">RelatedAgreement</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">umbrellaAgreement</span> <span class="kt">UmbrellaAgreement</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">LegalAgreementBase</span></code>, <code class="docutils literal notranslate"><span class="pre">RelatedAgreement</span></code>, <code class="docutils literal notranslate"><span class="pre">UmbrellaAgreement</span></code>, and <code class="docutils literal notranslate"><span class="pre">AgreementTerms</span></code> are defined in the following sections.</p>
<div class="section" id="agreement-identification">
<h4>Agreement Identification<a class="headerlink" href="#agreement-identification" title="Permalink to this headline">¶</a></h4>
<p>The CDM provides support for implementors to uniquely identify a legal agreement solely through the specification of the agreement identification features, as represented in the <code class="docutils literal notranslate"><span class="pre">LegalAgreementBase</span></code> abstract data type, which is illustrated below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">LegalAgreementBase:</span>
  <span class="n">agreementDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">effectiveDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">identifier</span> <span class="kt">Identifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">agreementType</span> <span class="kt">LegalAgreementType</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">contractualParty</span> <span class="kt">Party</span> <span class="p">(</span><span class="mi">2</span><span class="o">..</span><span class="mi">2</span><span class="p">)</span>
   <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
  <span class="n">otherParty</span> <span class="kt">PartyRole</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<p>As indicated by the cardinality for the attributes in this data type, all legal agreements must contain an agreement date, two contractual parties, and information indicating the published form of market standard agreement being used (including the name and publisher of the legal agreement being specified in the <code class="docutils literal notranslate"><span class="pre">agreementType</span></code> attribute).  Provision is made for further information to be captured, for example an agreement identifier, which is an optional attribute.</p>
</div>
<div class="section" id="related-agreement">
<h4>Related Agreement<a class="headerlink" href="#related-agreement" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">RelatedAgreement</span></code> is a data type used to specify any higher-level agreement(s) that may govern the agreement, either as a reference to such agreements when specified as part of the CDM, or through identification of some of the key terms of those agreements.</p>
<p>The below snippet represents the <code class="docutils literal notranslate"><span class="pre">RelatedAgreement</span></code> data type.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">RelatedAgreement:</span>
  <span class="n">legalAgreement</span> <span class="kt">LegalAgreement</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">documentationIdentification</span> <span class="kt">DocumentationIdentification</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Through the <code class="docutils literal notranslate"><span class="pre">legalAgreement</span></code> attribute the CDM provides support for implementors to do the following:</p>
<ul class="simple">
<li>Identify some of the key terms of a governing legal agreement such as the agreement identifier, the publisher, the document vintage, and the agreement date.</li>
<li>Or, reference the entire legal agreement that is electronically represented in the CDM through a reference key into the agreement instance.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">DocumentationIdentification</span></code> attribute is used to map related agreement terms that are embedded as part of a transaction message converted from another model structure, such as FpML.  For example, this attribute may reference an ISDA Master Agreement, which is not modelled or mapped in the CDM <code class="docutils literal notranslate"><span class="pre">LegalAgreement</span></code> data type.</p>
</div>
</div>
<div class="section" id="umbrella-agreement">
<h4>Umbrella Agreement<a class="headerlink" href="#umbrella-agreement" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">UmbrellaAgreement</span></code> is a data type used to specify the applicability of Umbrella Agreement terms, relevant specific language, and underlying entities associated with the umbrella agreement.</p>
<p>The below snippet represents the <code class="docutils literal notranslate"><span class="pre">UmbrellaAgreement</span></code> data type.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">UmbrellaAgreement:</span>
  <span class="n">isApplicable</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">language</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">parties</span> <span class="kt">UmbrellaAgreementEntity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="agreement-content">
<h4>Agreement Content<a class="headerlink" href="#agreement-content" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">AgreementTerms</span></code> is used to specify the content of a legal agreement in the CDM. There are two components to agreement terms, as shown in the code snippet below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">AgreementTerms:</span>
  <span class="n">agreement</span> <span class="kt">Agreement</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">counterparty</span> <span class="kt">Counterparty</span> <span class="p">(</span><span class="mi">2</span><span class="o">..</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The following sections describe each of these components.</p>
</div>
<div class="section" id="agreement">
<h4>Agreement<a class="headerlink" href="#agreement" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Agreement</span></code> is a data type used to specify the individual elections contained within the legal agreement. It contains a set of encapsulated data types, each containing the elections used to define a specific group of agreements.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Agreement:</span>
  <span class="n">creditSupportAgreementElections</span> <span class="kt">CreditSupportAgreementElections</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">collateralTransferAgreementElections</span> <span class="kt">CollateralTransferAgreementElections</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">securityAgreementElections</span> <span class="kt">SecurityAgreementElections</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">masterAgreementSchedule</span> <span class="kt">MasterAgreementSchedule</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">condition</span><span class="kt">:</span> <span class="n">one</span><span class="o">-</span><span class="kr">of</span>
</pre></div>
</div>
</div>
<div class="section" id="counterparty">
<h4>Counterparty<a class="headerlink" href="#counterparty" title="Permalink to this headline">¶</a></h4>
<p>Each counterparty to the agreement is assigned an enumerated value of either <code class="docutils literal notranslate"><span class="pre">Party1</span></code> or <code class="docutils literal notranslate"><span class="pre">Party2</span></code> through the association of a <code class="docutils literal notranslate"><span class="pre">CounterpartyRoleEnum</span></code> with the corresponding <code class="docutils literal notranslate"><span class="pre">Party</span></code>.  The <code class="docutils literal notranslate"><span class="pre">CounterpartyRoleEnum</span></code> value is then used to specify elections throughout the rest of the document.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">enum</span> <span class="kt">CounterpartyRoleEnum:</span>
  <span class="kt">Party1</span>
  <span class="kt">Party2</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Counterparty:</span>
  <span class="n">role</span> <span class="kt">CounterpartyRoleEnum</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">partyReference</span> <span class="kt">Party</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
   <span class="p">[</span><span class="n">metadata</span> <span class="n">reference</span><span class="p">]</span>
</pre></div>
</div>
<p>The modelling approach for elective provisions is explained in further detail in the corresponding section below.</p>
</div>
</div>
<div class="section" id="elective-provisions">
<h3>Elective Provisions<a class="headerlink" href="#elective-provisions" title="Permalink to this headline">¶</a></h3>
<p>This section describes the modelling approach and data structure for election provisions, which are the detailed terms of agreement in each legal document.  The section concludes with relevant examples to illustrate the approach and structure.</p>
<div class="section" id="id2">
<h4>Modelling Approach<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>In many cases the pre-printed clauses in legal agreement templates for OTC Derivatives offer pre-defined elections that the parties can select. In these cases, the clauses are explicitly identified in the agreement templates, including the potential values for each election (e.g. an election from a list of options or a specific type of information such as an amount, date or city). The design of the elective provisions in the CDM to represent these instances is a direct reflection of the choices in the clause and uses boolean attributes or enumeration lists to achieve the necessary outcome.</p>
<p>However, in some cases, the agreement template may identify a clause but not all the applicable values, e.g. when a single version of a clause term is provided with a space for parties to agree on a term that is not defined in the template. In order to support these instances, the CDM uses string attributes to capture the clause in a free text format.</p>
</div>
<div class="section" id="election-structure">
<h4>Election Structure<a class="headerlink" href="#election-structure" title="Permalink to this headline">¶</a></h4>
<p>For ease of reference, the structure of the elections contained within each agreement data type in the CDM are modelled to reflect the structure of the legal agreements that they represent. Each data type contains a set of elections or election families which can be used to represent the clauses contained within the corresponding legal agreement, regardless of vintage or governing law.</p>
<p>This approach allows the representation of elections in the CDM to focus on their intended business outcome in order to better support the standardisation of related business processes.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">CreditSupportAgreementElections</span></code> , which is one of the four agreement types, contains all the elections that may be applicable to a credit support agreement and can be used to define any of the Initial Margin or Variation Margin Credit Support Agreements supported by the CDM:</p>
<ul class="simple">
<li>ISDA 2016 Phase One Credit Support Annex (“CSA”) for Initial Margin (“IM”) (Security Interest – New York Law)</li>
<li>ISDA 2016 Phase One Credit Support Deed (“CSD”) for IM (Security Interest – English Law)</li>
<li>ISDA 2016 Phase One CSA for IM (Loan – Japanese Law)</li>
<li>ISDA 2018 CSA for IM (Security Interest – New York Law)</li>
<li>ISDA 2018 CSD for IM (Security Interest – English Law)</li>
<li>ISDA 2016 CSA for Variation Margin (“VM”) (Security Interest - New York Law)</li>
<li>ISDA 2016 CSA for VM (Title Transfer – English Law)</li>
<li>ISDA 2016 CSA for VM (Loan – Japanese Law)</li>
<li>ISDA 2016 CSA for VM (Title Transfer – Irish Law)</li>
<li>ISDA 2016 CSA for VM (Title Transfer – French Law)</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">CreditSupportAgreementElections</span></code> data type therefore contains a super-set of the elections that may apply to any of the above document types.  Common elections used in different document types are represented using common components in this data type.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">CreditSupportAgreementElections:</span>
  <span class="n">regime</span> <span class="kt">Regime</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">oneWayProvisions</span> <span class="kt">OneWayProvisions</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">generalSimmElections</span> <span class="kt">GeneralSimmElections</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">identifiedCrossCurrencySwap</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">sensitivityMethodologies</span> <span class="kt">SensitivityMethodologies</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">fxHaircutCurrency</span> <span class="kt">FxHaircutCurrency</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">postingObligations</span> <span class="kt">PostingObligations</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">substitutedRegime</span> <span class="kt">SubstitutedRegime</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">baseAndEligibleCurrency</span> <span class="kt">BaseAndEligibleCurrency</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalObligations</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">coveredTransactions</span> <span class="kt">CoveredTransactions</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">creditSupportObligations</span> <span class="kt">CreditSupportObligations</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">exchangeDate</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">calculationAndTiming</span> <span class="kt">CalculationAndTiming</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">conditionsPrecedent</span> <span class="kt">ConditionsPrecedent</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">substitution</span> <span class="kt">Substitution</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">disputeResolution</span> <span class="kt">DisputeResolution</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">holdingAndUsingPostedCollateral</span> <span class="kt">HoldingAndUsingPostedCollateral</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">rightsEvents</span> <span class="kt">RightsEvents</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">custodyArrangements</span> <span class="kt">CustodyArrangements</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">distributionAndInterestPayment</span> <span class="kt">DistributionAndInterestPayment</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">creditSupportOffsets</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalRepresentations</span> <span class="kt">AdditionalRepresentations</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">otherEligibleAndPostedSupport</span> <span class="kt">OtherEligibleAndPostedSupport</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">demandsAndNotices</span> <span class="kt">ContactElection</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">addressesForTransfer</span> <span class="kt">ContactElection</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">otherAgreements</span> <span class="kt">OtherAgreements</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">terminationCurrencyAmendment</span> <span class="kt">TerminationCurrencyAmendment</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">minimumTransferAmountAmendment</span> <span class="kt">MinimumTransferAmountAmendment</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">interpretationTerms</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">processAgent</span> <span class="kt">ProcessAgent</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">appropriatedCollateralValuation</span> <span class="kt">AppropriatedCollateralValuation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">jurisdictionRelatedTerms</span> <span class="kt">JurisdictionRelatedTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalAmendments</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalBespokeTerms</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">trustSchemeAddendum</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Validation exists in the model to ensure that the set of elections specified within the <code class="docutils literal notranslate"><span class="pre">Agreement</span></code> are consistent with the agreement identified as part of <code class="docutils literal notranslate"><span class="pre">LegalAgreementBase</span></code>.  The below snippet represents a sample of a validation condition:</p>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">condition</span> <span class="n">agreementVerification</span><span class="kt">:</span>
  <span class="kr">if</span> <span class="n">agreementTerms</span> <span class="ow">-&gt;</span> <span class="n">agreement</span> <span class="ow">-&gt;</span> <span class="n">securityAgreementElections</span> <span class="n">exists</span>
  <span class="kr">then</span> <span class="n">agreementType</span> <span class="ow">-&gt;</span> <span class="n">name</span> <span class="ow">=</span> <span class="kt">LegalAgreementNameEnum</span><span class="ow">-&gt;</span><span class="kt">SecurityAgreement</span>
</pre></div>
</div>
<p>The validation in this case requires that if the <code class="docutils literal notranslate"><span class="pre">securityAgreementElections</span></code> attribute is populated, then the value in <code class="docutils literal notranslate"><span class="pre">LegalAgreementNameEnum</span></code> must be <code class="docutils literal notranslate"><span class="pre">SecurityAgreement</span></code> .</p>
<p>Selected examples from two of the agreement data types are explained in the following sections to illustrate the overall approach.</p>
</div>
<div class="section" id="elective-provisions-example-1-posting-obligations">
<h4>Elective Provisions Example 1: Posting Obligations<a class="headerlink" href="#elective-provisions-example-1-posting-obligations" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">postingObligations</span></code> is one of the required attributes in <code class="docutils literal notranslate"><span class="pre">CreditSupportAgreementElections</span></code> .  It defines the security provider party to which a set of posting obligations applies and the applicable collateral posting obligations as indicated in the data structure shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">PostingObligations:</span>
  <span class="n">securityProvider</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">partyElection</span> <span class="kt">PostingObligationsElection</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">partyElection</span></code> attribute, which is of the type partyElection <code class="docutils literal notranslate"><span class="pre">PostingObligationsElection</span></code> defines the party that the collateral posting obligations apply to and defines the collateral that is eligible, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">PostingObligationsElection:</span>
  <span class="n">party</span> <span class="kt">CounterpartyRoleEnum</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">asPermitted</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">eligibleCollateral</span> <span class="kt">EligibleCollateralSchedule</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">excludedCollateral</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalLanguage</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to provide compatibility with ISDA Create the <code class="docutils literal notranslate"><span class="pre">party</span></code> attribute in CDM is represented as a string.  Implementors should populate this field with <code class="docutils literal notranslate"><span class="pre">PartyA</span></code> , <code class="docutils literal notranslate"><span class="pre">PartyB</span></code> , or <code class="docutils literal notranslate"><span class="pre">PartyAPartyB</span></code> as appropriate to represent the party that the election terms are being defined for.</p>
</div>
<p>The development of a digital data standard for representation of eligible collateral schedules is a crucial component required to drive digital negotiation, straight through processing, and digitisation of collateral management. The standard representation provided within the CDM allows institutions involved in the collateral workflow cycle to exchange eligible collateral information accurately and efficiently in digital form.  The <code class="docutils literal notranslate"><span class="pre">EligibleCollateral</span></code> data type is a root type with one attribute, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">EligibleCollateralSchedule:</span>
       <span class="p">[</span><span class="n">rootType</span><span class="p">]</span>
       <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
       <span class="n">scheduleIdentifier</span> <span class="kt">Identifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
       <span class="n">criteria</span> <span class="kt">EligibleCollateralCriteria</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">EligibleCollateralCriteria</span></code> data type contains the following key components to allow the digital representation of the detailed criteria reflected in the legal agreement:</p>
<ol class="arabic simple">
<li><strong>Collateral Issuer Criteria</strong> specifies criteria that the issuer of an asset (if any) must meet when defining collateral eligibility for that asset.</li>
<li><strong>Collateral Product Criteria</strong> specifies criteria that the product must meet when defining collateral eligibility.</li>
<li><strong>Collateral Treatment</strong> specifies criteria for the treatment of collateral assets, including whether the asset is identified as eligible or ineligible, and treatment when posted.</li>
</ol>
<p>The following code snippets represent these three components of the eligible collateral model. These components are assembled under the <code class="docutils literal notranslate"><span class="pre">EligibleCollateralCriteria</span></code> data type, which is contained within the <code class="docutils literal notranslate"><span class="pre">postingObligationElection</span></code> component of the credit support agreement elections described above.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">EligibleCollateralCriteria:</span>
  <span class="n">issuer</span> <span class="kt">IssuerCriteria</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">asset</span> <span class="kt">AssetCriteria</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">treatment</span> <span class="kt">CollateralTreatment</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">IssuerCriteria:</span>
  <span class="n">issuerType</span> <span class="kt">CollateralIssuerType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">issuerCountryOfOrigin</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">issuerName</span> <span class="kt">LegalEntity</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">issuerAgencyRating</span> <span class="kt">AgencyRatingCriteria</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">sovereignAgencyRating</span> <span class="kt">AgencyRatingCriteria</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">counterpartyOwnIssuePermitted</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">AssetCriteria:</span>
  <span class="n">collateralAssetType</span> <span class="kt">AssetType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">assetCountryOfOrigin</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">denominatedCurrency</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">agencyRating</span> <span class="kt">AgencyRatingCriteria</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">maturityType</span> <span class="kt">MaturityTypeEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">maturityRange</span> <span class="kt">PeriodRange</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">productIdentifier</span> <span class="kt">ProductIdentifier</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">collateralTaxonomy</span> <span class="kt">CollateralTaxonomy</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">domesticCurrencyIssued</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">listing</span> <span class="kt">ListingType</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">CollateralTreatment:</span>
  <span class="n">valuationTreatment</span> <span class="kt">CollateralValuationTreatment</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">concentrationLimit</span> <span class="kt">ConcentrationLimit</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">isIncluded</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="elective-provisions-example-2-security-agreement-elections">
<h4>Elective Provisions Example 2: Security Agreement Elections<a class="headerlink" href="#elective-provisions-example-2-security-agreement-elections" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">SecurityAgreementElections</span></code> data type is another one of the four agreement types.  Given the structure of this type, the CDM model supports nine distinct Security Agreements. Election structures across any of these agreements can be represented through the following data type:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">SecurityAgreementElections:</span>
  <span class="n">pledgedAccount</span> <span class="kt">Account</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">enforcementEvent</span> <span class="kt">EnforcementEvent</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">deliveryInLieuRight</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">fullDischarge</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">appropriatedCollateralValuation</span> <span class="kt">AppropriatedCollateralValuation</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">processAgent</span> <span class="kt">ProcessAgent</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">jurisdictionRelatedTerms</span> <span class="kt">JurisdictionRelatedTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalAmendments</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalBespokeTerms</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">executionTerms</span> <span class="kt">ExecutionTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Depending on the agreement being specified, a different combination of attributes would be used when specifying the agreement. The cardinality of each attribute allows the appropriate combination to be provided dependent on the agreement.</p>
<p>An equivalent approach is followed for <code class="docutils literal notranslate"><span class="pre">CreditSupportAgreementElections</span></code> and <code class="docutils literal notranslate"><span class="pre">CollateralTransferAgreementElections</span></code>.</p>
</div>
<div class="section" id="elective-provisions-example-3-credit-support-obligations">
<h4>Elective Provisions Example 3: Credit Support Obligations<a class="headerlink" href="#elective-provisions-example-3-credit-support-obligations" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">creditSupportObligations</span></code> attribute is contained within two of the agreement types: <code class="docutils literal notranslate"><span class="pre">CreditSupportAgreementElections</span></code> and <code class="docutils literal notranslate"><span class="pre">CollateralTransferAgreementElections</span></code>.  In both cases, the data type is <code class="docutils literal notranslate"><span class="pre">CreditSupportObligations</span></code>, which is used to represent a key set of terms that are fundamental to collateral calculations within these document families. The <code class="docutils literal notranslate"><span class="pre">CollateralTransferAgreementElections</span></code> data type is shown below, in which the <code class="docutils literal notranslate"><span class="pre">creditSupportObligations</span></code> is the tenth attribute:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">CollateralTransferAgreementElections:</span>
  <span class="n">regime</span> <span class="kt">Regime</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">oneWayProvisions</span> <span class="kt">OneWayProvisions</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">generalSimmElections</span> <span class="kt">GeneralSimmElections</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">identifiedCrossCurrencySwap</span> <span class="n">boolean</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">sensitivityMethodologies</span> <span class="kt">SensitivityMethodologies</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">fxHaircutCurrency</span> <span class="kt">FxHaircutCurrency</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">postingObligations</span> <span class="kt">PostingObligations</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">substitutedRegime</span> <span class="kt">SubstitutedRegime</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">baseAndEligibleCurrency</span> <span class="kt">BaseAndEligibleCurrency</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">creditSupportObligations</span> <span class="kt">CreditSupportObligations</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">calculationAndTiming</span> <span class="kt">CalculationAndTiming</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">conditionsPrecedent</span> <span class="kt">ConditionsPrecedent</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">substitution</span> <span class="kt">Substitution</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">disputeResolution</span> <span class="kt">DisputeResolution</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">rightsEvents</span> <span class="kt">RightsEvents</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">custodyArrangements</span> <span class="kt">CustodyArrangements</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalRepresentations</span> <span class="kt">AdditionalRepresentations</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">demandsAndNotices</span> <span class="kt">ContactElection</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">addressesForTransfer</span> <span class="kt">ContactElection</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">otherCsa</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">terminationCurrencyAmendment</span> <span class="kt">TerminationCurrencyAmendment</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">minimumTransferAmountAmendment</span> <span class="kt">MinimumTransferAmountAmendment</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">interpretationTerms</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">processAgent</span> <span class="kt">ProcessAgent</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">jurisdictionRelatedTerms</span> <span class="kt">JurisdictionRelatedTerms</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalAmendments</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">additionalBespokeTerms</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This set of elections in <code class="docutils literal notranslate"><span class="pre">CreditSupportObligations</span></code> is modelled to directly reflect the equivalent paragraph in the ISDA documentation, for example Paragraph 13 (c) of the ISDA 2018 CSA (Security Interest – New York Law).  The cardinality constraint requires <code class="docutils literal notranslate"><span class="pre">threshold</span></code> and <code class="docutils literal notranslate"><span class="pre">minimumTransferAmount</span></code> to be specified, as it is an elective provision in all the Credit Support Agreements supported in CDM.  Other clauses such as <code class="docutils literal notranslate"><span class="pre">marginApproach</span></code> are not elective provisions in all supported agreements so the cardinality indicates optionality.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">CreditSupportObligations:</span>
  <span class="n">deliveryAmount</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">returnAmount</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">marginApproach</span> <span class="kt">MarginApproach</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">otherEligibleSupport</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">threshold</span> <span class="kt">Threshold</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">minimumTransferAmount</span> <span class="kt">MinimumTransferAmount</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">rounding</span> <span class="kt">CollateralRounding</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">bespokeTransferTiming</span> <span class="kt">BespokeTransferTiming</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">creditSupportObligationsVariationMargin</span> <span class="kt">CreditSupportObligationsVariationMargin</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Each attribute is modelled based on the corresponding clause in the relevant legal agreement templates.  Therefore, each provides the necessary components to reflect the election structure. For example the attribute <code class="docutils literal notranslate"><span class="pre">rounding</span></code> is of data type <code class="docutils literal notranslate"><span class="pre">CollateralRounding</span></code> which allows the specification of rounding terms for the Delivery Amount and the Return Amount, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">CollateralRounding:</span>
  <span class="n">deliveryAmount</span> <span class="n">number</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">returnAmount</span> <span class="n">number</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The credit support obligations election data type, <code class="code docutils literal notranslate"><span class="pre">CreditSupportObligationsInitialMargin</span></code>, is suffixed with <code class="docutils literal notranslate"><span class="pre">InitialMargin</span></code>, because the initial set of credit support agreement documents that have been digitised in the CDM are Initial Margin CSAs.</p>
</div>
</div>
</div>
<div class="section" id="linking-legal-agreements-to-contracts">
<h3>Linking Legal Agreements to Contracts<a class="headerlink" href="#linking-legal-agreements-to-contracts" title="Permalink to this headline">¶</a></h3>
<p>Financial transactions defined in CDM can be referenced in the <code class="docutils literal notranslate"><span class="pre">ContractTradeDetails</span></code> data type.  This represents the transaction confirmation that is the legally binding agreement between two parties for an execution of a specified tradable product.  The <code class="docutils literal notranslate"><span class="pre">documentation</span></code> attribute uses the <code class="docutils literal notranslate"><span class="pre">RelatedAgreement</span></code> data type, which can be populated with the details for a relevant agreement that has been defined in the CDM.  For OTC derivatives, this attribute will contain a reference to the ISDA Master Agreement that governs any derivative transaction between the parties.</p>
<p>Similarly, the <code class="docutils literal notranslate"><span class="pre">ContractFormation</span></code> business event that creates the legally binding agreement between the parties can reference a <code class="docutils literal notranslate"><span class="pre">LegalAgreement</span></code> governing the transaction.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">Create_ContractFormation:</span>
  <span class="p">[</span><span class="n">creation</span> <span class="kt">BusinessEvent</span><span class="p">]</span>
  <span class="n">inputs</span><span class="kt">:</span>
    <span class="n">contractFormationInstruction</span> <span class="kt">ContractFormationInstruction</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">contractFormationDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The functions to create such business events are further detailed in the <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#lifecycle-event-process">Lifecycle Event Process Section</a> of the documentation.</p>
</div>
</div>
</div>
<div class="section" id="process-model">
<h2>Process Model<a class="headerlink" href="#process-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="purpose">
<h3>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h3>
<div class="section" id="why-a-process-model">
<h4>Why a Process Model<a class="headerlink" href="#why-a-process-model" title="Permalink to this headline">¶</a></h4>
<p><strong>The CDM lays the foundation for the standardisation, automation and inter-operability of industry processes</strong>. Industry processes represent events and actions that occur through the transaction’s lifecycle, from negotiating a legal agreement to allocating a block-trade or calculating settlement amounts.</p>
<p>While ISDA defines the protocols for industry processes in its library of ISDA Documentation, differences in the implementation minutia may cause operational friction between market participants. Evidence shows that even when calculations are defined in mathematical notation (for example, day count fraction formulae which are used when calculating interest rate payments) can be a source of dispute between parties in a transaction.</p>
</div>
<div class="section" id="what-is-the-process-model">
<h4>What Is the Process Model<a class="headerlink" href="#what-is-the-process-model" title="Permalink to this headline">¶</a></h4>
<p><strong>The CDM Process Model has been designed to translate the technical standards that support those industry processes</strong> into a standardised machine-readable and machine-executable format.</p>
<p>Machine readability and executability is crucial to eliminate implementation discrepancy between market participants and increase interoperability between technology solutions. It greatly minimises the cost of adoption and provides a blueprint on which industry utilities can be built.</p>
</div>
<div class="section" id="how-does-it-work">
<h4>How Does It Work<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h4>
<p>The data and proces model definitions of the CDM are systematically translated into executable code using purpose-built code generation technology. The CDM executable code is available in a number of modern, widely adopted and freely available programming languages and is systematically distributed as part of the CDM release.</p>
<p>The code generation process is based on the Rosetta DSL and is further described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/codegen-readme.html">Code Generation Section</a>, including an up-to-date <a class="reference external" href="https://docs.rosetta-technology.io/dsl/codegen-readme.html#what-code-generators-are-available">list of available languages</a>. Support for further languages can be added as required by market participants.</p>
</div>
</div>
<div class="section" id="id3">
<h3>Scope<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>The scope of the process model has two dimensions:</p>
<ol class="arabic simple">
<li><strong>Coverage</strong> - which industry processes should be covered.</li>
<li><strong>Granularity</strong> - at which level of detail each process should be specified.</li>
</ol>
<div class="section" id="coverage">
<h4>Coverage<a class="headerlink" href="#coverage" title="Permalink to this headline">¶</a></h4>
<p><strong>The CDM process model currently covers the post-trade lifecycle of securities, contractual products, and foreign exchange</strong>. Generally, a process is in-scope when it is already covered in ISDA Documentation or other technical documents. For example, the following processes are all in scope:</p>
<ul class="simple">
<li>Trade execution and confirmation</li>
<li>Clearing</li>
<li>Allocation</li>
<li>Reallocation</li>
<li>Settlement (including any future contingent cashflow payment)</li>
<li>Return (settlement of the part and/or full return of the loaned security as defined by a Securities Lending transaction.)</li>
<li>Billing (calculation and population of invoicing for Securities Lending transactions)</li>
<li>Exercise of options</li>
<li>Margin calculation</li>
<li>Regulatory reporting (although covered in a different documentation section)</li>
</ul>
</div>
<div class="section" id="granularity">
<h4>Granularity<a class="headerlink" href="#granularity" title="Permalink to this headline">¶</a></h4>
<p><strong>It is important for implementors of the CDM to understand the scope of the model</strong> with regard to specifications and executable code for the above list of post-trade lifecycle processes.</p>
<p>The CDM process model leverages the <em>function</em> component of the Rosetta DSL. As detailed in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#function-component">Function Component Section</a> of the documentation, a function receives a set of input values and applies logical instructions to return an output. The input and output are both CDM objects (including basic types). While a function specifies its inputs and output, its logic may be <em>fully defined</em> or only <em>partially defined</em> depending on how much of the output’s attribute values it builds. Unspecified parts of a process represent functionality that firms are expected to implement, either internally or through third-parties such as utilities.</p>
<p>It is not always possible or practical to fully specify the business logic of a process from a model. Parts of processes or sub-processes may be omitted from the CDM for the following reasons:</p>
<ul class="simple">
<li>The sub-process is not needed to create a functional CDM output object.</li>
<li>The sub-process has already been defined and its implementation is widely adopted by the industry.</li>
<li>The sub-process is specific to a firm’s internal process and therefore cannot be specified in an industry standard.</li>
</ul>
<p>Given these reasons, the CDM process model focuses on the most critical data and processes required to create functional objects that satisfy the below criterion:</p>
<ul class="simple">
<li>All of the qualifiable constituents (such as <code class="docutils literal notranslate"><span class="pre">BusinessEvent</span></code> and <code class="docutils literal notranslate"><span class="pre">Product</span></code>) of a function’s output can be qualified, which means that they evaluate to True according to at least one of the applicable Qualification functions.</li>
<li>Lineage and cross-referencing between objects is accurate for data integrity purposes.</li>
</ul>
<p>For any remaining data or processes, implementors can populate the remaining attribute values required for the output to be valid by extending the executable code generated by the process model or by creating their own functions.</p>
<p>For the trade lifecycle processes that are in scope, the CDM process model covers the following sub-process components, which are each detailed in the next sections:</p>
<ol class="arabic simple">
<li>Validation process</li>
<li>Calculation process</li>
<li>Event creation process</li>
</ol>
</div>
</div>
<div class="section" id="validation-process">
<h3>Validation Process<a class="headerlink" href="#validation-process" title="Permalink to this headline">¶</a></h3>
<p>In many legacy models and technical standards, validation rules are generally specified in text-based documentation, which requires software engineers to evaluate and translate the logic into code. The frequently occuring result of this human interpretation process is inconsistent enforcement of the intended logic.</p>
<p>By contrast, in the CDM, validation components are an integral part of the process model specifications and are distributed as executable code in the Java representation of the CDM. The CDM validation components leverage the validation components of the Rosetta DSL, as described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#validation-component">Validation Component Section</a>.</p>
<div class="section" id="product-validation">
<h4>Product Validation<a class="headerlink" href="#product-validation" title="Permalink to this headline">¶</a></h4>
<p>As an example, the <em>FpML ird validation rule #57</em>, states that if the calculation period frequency is expressed in units of month or year, then the roll convention cannot be a weekday. A machine readable and executable definition of that specification is provided in the CDM, as a <code class="docutils literal notranslate"><span class="pre">condition</span></code> attached to the <code class="docutils literal notranslate"><span class="pre">CalculationPeriodFrequency</span></code> type:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">condition</span> <span class="kt">FpML_ird_57:</span>
  <span class="kr">if</span> <span class="n">period</span> <span class="ow">=</span> <span class="kt">PeriodExtendedEnum</span> <span class="ow">-&gt;</span> <span class="kt">M</span> <span class="n">or</span> <span class="n">period</span> <span class="ow">=</span> <span class="kt">PeriodExtendedEnum</span> <span class="ow">-&gt;</span> <span class="kt">Y</span>
  <span class="kr">then</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">NONE</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">SFE</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">MON</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">TUE</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">WED</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">THU</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">FRI</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">SAT</span>
    <span class="n">or</span> <span class="n">rollConvention</span> <span class="o">&lt;&gt;</span> <span class="kt">RollConventionEnum</span> <span class="ow">-&gt;</span> <span class="kt">SUN</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="calculation-process">
<h3>Calculation Process<a class="headerlink" href="#calculation-process" title="Permalink to this headline">¶</a></h3>
<p>The CDM provides certain ISDA Definitions as machine executable formulas to standardise the industry calculation processes that depend on those definitions.  Examples include the ISDA 2006 definitions of <em>Fixed Amount</em> and <em>Floating Amount</em> , the ISDA 2006 definitions of Day Count Fraction rules, and performance calculations for Equity Swaps. The CDM also specifies related utility functions.</p>
<p>These calculation processes leverage the <em>calculation function</em> component of the Rosetta DSL, as detailed in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#function-definition">Function Definition Section</a>, and accordingly are associated to a <code class="docutils literal notranslate"><span class="pre">calculation</span></code> annotation.</p>
<p>Explanations of these processes are provided in the following sections.</p>
<div class="section" id="base-libraries-vector-math">
<h4>Base Libraries - Vector Math<a class="headerlink" href="#base-libraries-vector-math" title="Permalink to this headline">¶</a></h4>
<p>The CDM includes a very basic library for performing vector math.  This is intended to support more complex calculations such as daily compounded floating amounts.   The CDM includes a basic implementation of these functions in Java, and allows individual implementations to substitute their own more robust representations.</p>
<p>A small library of functions for working with vectors (ordered collections of numbers) has been added to CDM to support Rosetta functions needing to perform complex mathematical operations.  Anticipated uses include averaging and compounding calculations for floating amounts, but the functions are designed to be general use.</p>
<p>The functions are located in base-math-func.</p>
<p>Functions include:</p>
<ul class="simple">
<li>ToVector: Creates a vector from a list of numbers.</li>
<li>SelectFromVector: Selects a single value from a vector (list of numbers), i.e. result = val[index].</li>
</ul>
<p>Returns null if the supplied vector is empty or if the supplied index is out of range.
Returns the first element of the vector when supplied an index of 0, and the index - 1 th element if index is in range.
* LastInVector: Returns the last value in a vector.  If the vector is empty, returns null
* AppendToVector: Appends a single value to a vector
* VectorOperation: Generates a result vector by applying the supplied arithmetic operation to each element of the supplied left and right vectors in turn.  i.e. result[n] = left[n] [op] right[n], where [op] is the arithmetic operation defined by arithmeticOp.   This function can be used to, for example, multiply or add two vectors.
* VectorScalarOperation: Generates a result vector by applying the supplied arithemetic operation and scalar right value to each element of the supplied left vector in turn. i.e. result[n] = left[n] [op] right, where [op] is the arithmetic operation defined by arithmeticOp.  This function can be used to, for example, multiply a vector by a scalar value, or add a scalar to a vector.
* VectorGrowthOperation: Generates a result vector by starting with the supplied base value (typically 1), and then multiplying it in turn by each growth factor, which is typically a number just above 1.  For instance, a growth factor of 1.1 reprsents a 10% increase, and 0.9 a 10% decrease.  The results will show the successive results of applying the successive growth factors, with the first value of the list being the supplied baseValue, and final value of the results list being the product of all of the supplied values.  i.e. result[1] = baseValue * factor[1], result[n] = result[n-1] * factor[n].  The resulting list will have the one more element than the supplied list of factors.  This function is useful for performing compounding calculations.</p>
<p>Also a new scalar functions has been added to better support floating rate processing:
* Round to precision:  Rounds a supplied number to a specified precison (in decimal places) using a roundingMode of type RoundingDirectionEnum.  This is similar to RoundToNearest but takes a precision rather than an amount, and uses a different rounding mode enumeration that supports more values.</p>
</div>
<div class="section" id="base-libraries-date-math">
<h4>Base Libraries - Date Math<a class="headerlink" href="#base-libraries-date-math" title="Permalink to this headline">¶</a></h4>
<p>The CDM includes a very basic library for performing date math.  This is intended to support more complex calculations such as daily compounded floating amounts.   The CDM includes a basic implementation of these functions in Java, and allows individual implementations to substitute their own more robust representations.</p>
<p>A small library of functions for working with dates and lists of dates has been added to CDM to support Rosetta
functions needing to perform date mathematics.  Anticipated uses include date list generation for modular rate
calculations for floating amounts, but the functions are designed to be general use.</p>
<p>There is a basic Java language implementation that can be used, or users can provide their own implementations
of these fuctions using a more robust date math library.</p>
<p>The functions are located in base-datetime-func.</p>
<p>Functions include:</p>
<ul class="simple">
<li>CombineBusinessCenters: Creates a BusinessCenters object that includes the union of business centers in the two supplied lists</li>
<li>RetrieveBusinessCenterHolidays: Returns a merged list of holidays for the supplied business centers</li>
<li>DayOfWeek: returns the day of week corresponding to the supplied date</li>
<li>AddDays: adds the specified number of calendar days to the supplied date.  A negative number will generate a date before the supplied date.</li>
<li>DateDifference: subtracts the two supplied dates to return the number of calendar days between them .  A negative number implies first is after second.</li>
<li>LeapYearDateDifference: subtracts the two supplied dates to return the number of leap year calendar days between them.(That is, the number of dates that happen to fall within a leap year.)  A negative number implies firstDate is after secondDate.</li>
<li>SelectDate: Select a date from a list of dates based on index.  If not found return nothing.</li>
<li>LastInDateList: Return the last date in a list of dates</li>
<li>AppendDateToList: Add a date to a list of dates</li>
<li>PopOffDateList:  Remove last element from a list of dates</li>
</ul>
<p>The following are implemented in Rosetta based on the above primitives.
* IsWeekend: returns whether the supplied date is a weekend.  This implementation currently assumes a 5 day week with Saturday and Sunday as holidays.  A more sophisticated implementation might use the business centers to determine which days are weekends, but most jurisdictions where derivatives are traded follow this convention.
* IsHoliday: Returns whether a day is a holiday for the specified business centers
* IsBusinessDay: returns an indicator of whether the supplied date is a good business date given the supplied business centers.  True =&gt; good date, i.e. not a weekend or holiday. False means that it is either a weekend or a holiday
* AddBusinessDays: Returns a good business date that has been offset by the given number of business days given the supplied business centers.  A negative value implies an earlier date (before the supplied originalDate), and a positive value a later date (after the supplied date).
* GenerateDateList: Creates a list of good business days starting from the startDate and going to the end date, inclusive, omitting any days that are weekends or holidays according to the supplied business centers.</p>
</div>
<div class="section" id="fixed-amount-and-floating-amount-definitions">
<h4>Fixed Amount and Floating Amount Definitions<a class="headerlink" href="#fixed-amount-and-floating-amount-definitions" title="Permalink to this headline">¶</a></h4>
<p>The CDM expressions of <code class="docutils literal notranslate"><span class="pre">FixedAmount</span></code> and <code class="docutils literal notranslate"><span class="pre">FloatingAmount</span></code> are similar in structure: a calculation formula that reflects the terms of the ISDA 2006 Definitions and the arguments associated with the formula.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl class="docutils">
<dt>func FloatingAmount:</dt>
<dd><p class="first">[calculation]
inputs:</p>
<blockquote>
<div>interestRatePayout InterestRatePayout (1..1)
spread number (1..1)
rate number (1..1)
quantity Quantity (1..1)
date date (1..1)
calculationPeriodData CalculationPeriodData (0..1)</div></blockquote>
<dl class="last docutils">
<dt>output:</dt>
<dd>floatingAmount number (1..1)</dd>
<dt>alias calculationAmount:</dt>
<dd>quantity -&gt; amount</dd>
<dt>alias calculationPeriod:</dt>
<dd>if calculationPeriodData exists then calculationPeriodData else CalculationPeriod(interestRatePayout -&gt; calculationPeriodDates, date)</dd>
<dt>alias dayCountFraction:</dt>
<dd>DayCountFraction(interestRatePayout, interestRatePayout -&gt; dayCountFraction, date, calculationPeriod)</dd>
<dt>assign-output floatingAmount:</dt>
<dd>calculationAmount * (rate + spread) * dayCountFraction</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="day-count-fraction">
<h4>Day Count Fraction<a class="headerlink" href="#day-count-fraction" title="Permalink to this headline">¶</a></h4>
<p>The CDM process model incorporates calculations that represent the set of day count fraction rules specified as part of the ISDA 2006 Definitions, e.g. the <em>ACT/365.FIXED</em> and the <em>30E/360</em> day count fraction rules. Although these rules are widely accepted in international markets, many of them have complex nuances which can lead to inconsistent implementations and potentially mismatched settlements.</p>
<p>For example, there are three distinct rule sets in which the length of each month is generally assumed to be 30 days for accrual purposes (and each year is assumed to be 360 days). However there are nuances in the rule sets that distinquish the resulting calculations under different circumstances, such as when the last day of the period is the last day of February. These distinct rule sets are defined by ISDA as 30/360 (also known as 30/360 US), 30E/360 (formerly known as 30/360 ICMA or 30/360 Eurobond), and the 30E/360.ISDA.</p>
<p>The CDM process model eliminates the need for implementators to interpret the logic and write unique code for these rules. Instead, it provides a machine-readable expression that generates executable code, such as the example below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl class="docutils">
<dt>func DayCountFraction(dayCountFractionEnum: DayCountFractionEnum -&gt; _30E_360): &lt;“‘2006 ISDA Definition Article 4 section 4.16(e): if ‘Actual/360’, ‘Act/360’ or ‘A/360’ is specified, the actual number of days in the Calculation Period or Compounding Period in respect of which payment is being made divided by 360.”&gt;</dt>
<dd><p class="first">[calculation]</p>
<p>alias startYear: calculationPeriod -&gt; startDate -&gt; year
alias endYear: calculationPeriod -&gt; endDate -&gt; year
alias startMonth: calculationPeriod -&gt; startDate -&gt; month
alias endMonth: calculationPeriod -&gt; endDate -&gt; month
alias endDay: Min(calculationPeriod -&gt; endDate -&gt; day, 30)
alias startDay: Min(calculationPeriod -&gt; startDate -&gt; day, 30)</p>
<dl class="last docutils">
<dt>assign-output result:</dt>
<dd>(360 * (endYear - startYear) + 30 * (endMonth - startMonth) + (endDay - startDay)) / 360</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="utility-function">
<h4>Utility Function<a class="headerlink" href="#utility-function" title="Permalink to this headline">¶</a></h4>
<p>CDM elements often need to be transformed by a function to construct the arguments for a formula in a calculation. A typical example is the requirement to identify a period start date, end date, and other date-related attributes required to compute a cashflow amount in accordance with a schedule (as illustrated in the day count fraction calculation shown above). The CDM has two main types to address this requirement:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CalculationPeriodDates</span></code> specifies the inputs required to construct a calculation period schedule</li>
<li><code class="docutils literal notranslate"><span class="pre">CalculationPeriodData</span></code> specifies actual attribute values of a calculation period such as start date, end date, etc.</li>
</ul>
<p>The CalculationPeriod function receives the <code class="docutils literal notranslate"><span class="pre">CalculationPeriodDates</span></code> and the current date as the inputs and produces the <code class="docutils literal notranslate"><span class="pre">CalculationPeriodData</span></code> as the output, as shown below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">CalculationPeriod:</span>
  <span class="n">inputs</span><span class="kt">:</span>
    <span class="n">calculationPeriodDates</span> <span class="kt">CalculationPeriodDates</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">date</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">output</span><span class="kt">:</span> <span class="n">result</span> <span class="kt">CalculationPeriodData</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="equity-performance">
<h4>Equity Performance<a class="headerlink" href="#equity-performance" title="Permalink to this headline">¶</a></h4>
<p>The CDM process model includes calculations to support the equity performance concepts applied to reset and pay cashflows on Equity Swaps. Those calculations follow the definitions as normalised in the new <em>2018 ISDA CDM Equity Confirmation for Security Equity Swap</em> (although this is a new template that is not yet in use across the industry).</p>
<p>Some of those calculations are presented below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">EquityCashSettlementAmount:</span>
    <span class="n">inputs</span><span class="kt">:</span>
        <span class="n">tradeState</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">date</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">output</span><span class="kt">:</span>
        <span class="n">equityCashSettlementAmount</span> <span class="kt">Cashflow</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">alias</span> <span class="n">equityPayout</span><span class="kt">:</span>
        <span class="n">tradeState</span> <span class="ow">-&gt;</span> <span class="n">trade</span> <span class="ow">-&gt;</span> <span class="n">tradableProduct</span> <span class="ow">-&gt;</span> <span class="n">product</span> <span class="ow">-&gt;</span> <span class="n">contractualProduct</span> <span class="ow">-&gt;</span> <span class="n">economicTerms</span> <span class="ow">-&gt;</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">equityPayout</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span>
    <span class="n">alias</span> <span class="n">equityPerformance</span><span class="kt">:</span>
        <span class="kt">EquityPerformance</span><span class="p">(</span><span class="n">tradeState</span> <span class="ow">-&gt;</span><span class="n">trade</span><span class="p">,</span> <span class="n">tradeState</span> <span class="ow">-&gt;</span> <span class="n">resetHistory</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span> <span class="ow">-&gt;</span> <span class="n">resetValue</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
    <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">equityCashSettlementAmount</span> <span class="ow">-&gt;</span> <span class="n">cashflowAmount</span> <span class="ow">-&gt;</span> <span class="n">amount</span><span class="kt">:</span>
        <span class="kt">Abs</span><span class="p">(</span><span class="n">equityPerformance</span><span class="p">)</span>
    <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">equityCashSettlementAmount</span> <span class="ow">-&gt;</span> <span class="n">cashflowAmount</span> <span class="ow">-&gt;</span> <span class="n">unitOfAmount</span><span class="ow">-&gt;</span> <span class="n">currency</span><span class="kt">:</span>
        <span class="kt">ResolveEquityInitialPrice</span><span class="p">(</span> <span class="n">tradeState</span> <span class="ow">-&gt;</span> <span class="n">trade</span> <span class="ow">-&gt;</span> <span class="n">tradableProduct</span> <span class="ow">-&gt;</span> <span class="n">tradeLot</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span> <span class="ow">-&gt;</span> <span class="n">priceQuantity</span> <span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">unitOfAmount</span> <span class="ow">-&gt;</span> <span class="n">currency</span>
    <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">equityCashSettlementAmount</span> <span class="ow">-&gt;</span> <span class="n">payerReceiver</span> <span class="ow">-&gt;</span> <span class="n">payer</span><span class="kt">:</span>
        <span class="kr">if</span> <span class="n">equityPerformance</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="kr">then</span> <span class="n">equityPayout</span> <span class="ow">-&gt;</span> <span class="n">payerReceiver</span> <span class="ow">-&gt;</span> <span class="n">payer</span> <span class="kr">else</span> <span class="n">equityPayout</span> <span class="ow">-&gt;</span> <span class="n">payerReceiver</span> <span class="ow">-&gt;</span> <span class="n">receiver</span>
    <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">equityCashSettlementAmount</span> <span class="ow">-&gt;</span> <span class="n">payerReceiver</span> <span class="ow">-&gt;</span> <span class="n">receiver</span><span class="kt">:</span>
        <span class="kr">if</span> <span class="n">equityPerformance</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="kr">then</span> <span class="n">equityPayout</span> <span class="ow">-&gt;</span> <span class="n">payerReceiver</span> <span class="ow">-&gt;</span> <span class="n">receiver</span> <span class="kr">else</span> <span class="n">equityPayout</span> <span class="ow">-&gt;</span> <span class="n">payerReceiver</span> <span class="ow">-&gt;</span> <span class="n">payer</span>
   <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">equityCashSettlementAmount</span> <span class="ow">-&gt;</span> <span class="n">cashflowDate</span> <span class="ow">-&gt;</span> <span class="n">adjustedDate</span><span class="kt">:</span>
        <span class="kt">ResolveCashSettlementDate</span><span class="p">(</span><span class="n">tradeState</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">RateOfReturn:</span>
       <span class="n">inputs</span><span class="kt">:</span>
               <span class="n">initialPrice</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">finalPrice</span> <span class="kt">Price</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span>
               <span class="n">rateOfReturn</span> <span class="n">number</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

       <span class="n">alias</span> <span class="n">initialPriceValue</span><span class="kt">:</span>
               <span class="n">initialPrice</span><span class="ow">-&gt;</span><span class="n">amount</span>
       <span class="n">alias</span> <span class="n">finalPriceValue</span><span class="kt">:</span>
               <span class="n">finalPrice</span><span class="ow">-&gt;</span><span class="n">amount</span>
       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">rateOfReturn</span><span class="kt">:</span>
               <span class="p">(</span><span class="n">finalPriceValue</span> <span class="o">-</span> <span class="n">initialPriceValue</span><span class="p">)</span> <span class="o">/</span> <span class="n">initialPriceValue</span>
</pre></div>
</div>
</div>
<div class="section" id="initial-margin">
<h4>Initial Margin<a class="headerlink" href="#initial-margin" title="Permalink to this headline">¶</a></h4>
<p>The CDM process model includes calculations to support the Delivery and Return amount concepts applied to the posting of Initial Margin. Those calculations follow the definitions as normalised in the <em>ISDA 2018 CSA (Security Interest – New York Law)</em></p>
<p>Some of those calculations are presented below:</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">DeliveryAmount:</span>
      <span class="p">[</span><span class="n">calculation</span><span class="p">]</span>
  <span class="n">inputs</span><span class="kt">:</span>
    <span class="n">postedCreditSupportItems</span> <span class="kt">PostedCreditSupportItem</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="n">priorDeliveryAmountAdjustment</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">priorReturnAmountAdjustment</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">disputedTransferredPostedCreditSupportAmount</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">marginAmount</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">threshold</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">marginApproach</span> <span class="kt">MarginApproachEnum</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">marginAmountIA</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">minimumTransferAmount</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">rounding</span> <span class="kt">CollateralRounding</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">disputedDeliveryAmount</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">baseCurrency</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">output</span><span class="kt">:</span>
    <span class="n">result</span> <span class="kt">Money</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">alias</span> <span class="n">undisputedAdjustedPostedCreditSupportAmount</span><span class="kt">:</span>
    <span class="kt">UndisputedAdjustedPostedCreditSupportAmount</span><span class="p">(</span><span class="n">postedCreditSupportItems</span><span class="p">,</span> <span class="n">priorDeliveryAmountAdjustment</span><span class="p">,</span> <span class="n">priorReturnAmountAdjustment</span><span class="p">,</span> <span class="n">disputedTransferredPostedCreditSupportAmount</span><span class="p">,</span> <span class="n">baseCurrency</span><span class="p">)</span>

  <span class="n">alias</span> <span class="n">creditSupportAmount</span><span class="kt">:</span>
    <span class="kt">CreditSupportAmount</span><span class="p">(</span><span class="n">marginAmount</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">marginApproach</span><span class="p">,</span> <span class="n">marginAmountIA</span><span class="p">,</span> <span class="n">baseCurrency</span><span class="p">)</span>

  <span class="n">alias</span> <span class="n">deliveryAmount</span><span class="kt">:</span>
    <span class="kt">Max</span><span class="p">(</span><span class="n">creditSupportAmount</span> <span class="ow">-&gt;</span> <span class="n">amount</span> <span class="o">-</span> <span class="n">undisputedAdjustedPostedCreditSupportAmount</span> <span class="ow">-&gt;</span> <span class="n">amount</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

  <span class="n">alias</span> <span class="n">undisputedDeliveryAmount</span><span class="kt">:</span>
    <span class="kt">Max</span><span class="p">(</span><span class="n">deliveryAmount</span> <span class="o">-</span> <span class="n">disputedDeliveryAmount</span> <span class="ow">-&gt;</span> <span class="n">amount</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

  <span class="n">condition</span><span class="kt">:</span>
    <span class="p">(</span><span class="n">baseCurrency</span> <span class="ow">=</span> <span class="n">minimumTransferAmount</span> <span class="ow">-&gt;</span> <span class="n">unitOfAmount</span> <span class="ow">-&gt;</span> <span class="n">currency</span>
    <span class="n">and</span> <span class="p">(</span><span class="n">baseCurrency</span> <span class="ow">=</span> <span class="n">disputedDeliveryAmount</span> <span class="ow">-&gt;</span> <span class="n">unitOfAmount</span> <span class="ow">-&gt;</span> <span class="n">currency</span><span class="p">))</span>

  <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">result</span> <span class="ow">-&gt;</span> <span class="n">amount</span><span class="kt">:</span>
    <span class="kr">if</span> <span class="n">undisputedDeliveryAmount</span> <span class="o">&gt;=</span> <span class="n">minimumTransferAmount</span> <span class="ow">-&gt;</span> <span class="n">amount</span>
    <span class="kr">then</span> <span class="kt">RoundToNearest</span><span class="p">(</span><span class="n">undisputedDeliveryAmount</span><span class="p">,</span> <span class="n">rounding</span> <span class="ow">-&gt;</span> <span class="n">deliveryAmount</span><span class="p">,</span> <span class="kt">RoundingModeEnum</span> <span class="ow">-&gt;</span> <span class="kt">Up</span><span class="p">)</span>
    <span class="kr">else</span> <span class="mf">0.0</span>

  <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">result</span> <span class="ow">-&gt;</span> <span class="n">unitOfAmount</span> <span class="ow">-&gt;</span> <span class="n">currency</span><span class="kt">:</span>
    <span class="n">baseCurrency</span>
</pre></div>
</div>
</div>
<div class="section" id="billing">
<h4>Billing<a class="headerlink" href="#billing" title="Permalink to this headline">¶</a></h4>
<p>The CDM process model includes calculations to support the billing event consisting of the individual amounts that need to be settled in relation to a portfolio of Security Loans.  These calculations leverage the <code class="code docutils literal notranslate"><span class="pre">FixedAmount</span></code>, <code class="code docutils literal notranslate"><span class="pre">FloatingAmount</span></code> and <code class="code docutils literal notranslate"><span class="pre">Day</span> <span class="pre">Count</span> <span class="pre">Fraction</span></code> calculations described earlier in the documentation.  A functional model is provided to populate the <code class="code docutils literal notranslate"><span class="pre">SecurityLendingInvoice</span></code> data type following the definitions as normalised in the <em>ISLA best practice handbook</em></p>
<p>The data type and function to generate a Security Lending Invoice:</p>
</div>
</div>
<div class="section" id="lifecycle-event-process">
<h3>Lifecycle Event Process<a class="headerlink" href="#lifecycle-event-process" title="Permalink to this headline">¶</a></h3>
<p>While the lifecycle event model described in the <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#event-model">Event Model Section</a> provides a standardised data representation of those events using the concept of <em>primitive event</em> components, the CDM must further specify the processing of those events to ensure standardised implementations across the industry. This means specifying the <em>logic</em> of the state-transition as described by each primitive event component.</p>
<p>In particular, the CDM must ensure that:</p>
<ul class="simple">
<li>The lifecycle event process model constructs valid CDM event objects.</li>
<li>The constructed events qualify according to the qualification logic described in the <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#event-qualification">Event Qualification Section</a>.</li>
<li>The lineage between states allows an accurate reconstruction of the trade’s lifecycle sequence.</li>
</ul>
<p>There are three levels of function components in the CDM to define the processing of lifecycle events:</p>
<ol class="arabic simple">
<li>Primitive creation</li>
<li>Event creation</li>
<li>Workflow step creation</li>
</ol>
<p>Each of those components can leverage any calculation or utility function already defined in the CDM. As part of the validation processe embedded in the CDM, an object validation step is included in all these object creation functions to ensure that they each construct valid CDM objects. Further details on the underlying calculation and validation processes are described in the <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#calculation-process">Calculation Process Section</a> and <a class="reference external" href="https://docs.rosetta-technology.io/cdm/documentation/source/documentation.html#validation-process">Validation Process Section</a>.</p>
<p>Illustration of the three components are given in the sections below.</p>
<div class="section" id="primitive-creation">
<h4>Primitive Creation<a class="headerlink" href="#primitive-creation" title="Permalink to this headline">¶</a></h4>
<p>Primitive creation functions can be thought of as the fundamental mathematical operators that operate on a <em>trade state</em>. While a primitive event object describes each state transition in terms of <em>before</em> and <em>after</em> trade states, a primitive creation function defines the logic to transition from that <em>before</em> trade state to the <em>after</em> trade state, using a set of <em>instructions</em>.</p>
<p>An example of such use is captured in the reset event of an Equity Swap. The reset is processed in following steps:</p>
<p>1. Resolve the <code class="docutils literal notranslate"><span class="pre">Observation</span></code> that contains the equity price, using specific product definition terms defined on <code class="docutils literal notranslate"><span class="pre">EquityPayout</span></code>.
1. Construct a <code class="docutils literal notranslate"><span class="pre">Reset</span></code> using the equity price on <code class="docutils literal notranslate"><span class="pre">Observation</span></code>. In this scenario, the reset value is the equity price.
1. Append <code class="docutils literal notranslate"><span class="pre">Reset</span></code> onto <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>, creating a new instance of <code class="docutils literal notranslate"><span class="pre">TradeState</span></code>.</p>
<p>At the end of each period in the life of the Equity Swap, the reset process will append further reset values onto the <em>trade state</em>. The series of equity prices then supports equity performance calculation as each reset value will represent the equity price at the end of one period and the start of the next.</p>
<p>These above steps are codified in the <code class="docutils literal notranslate"><span class="pre">Create_ResetPrimitive</span></code> function, which defines how the <code class="docutils literal notranslate"><span class="pre">ResetPrimitive</span></code> instance should be constructed.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">Create_ResetPrimitive:</span>
       <span class="p">[</span><span class="n">creation</span> <span class="kt">PrimitiveEvent</span><span class="p">]</span>
       <span class="n">inputs</span><span class="kt">:</span>
               <span class="n">tradeState</span> <span class="kt">TradeState</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">instruction</span> <span class="kt">ResetInstruction</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">resetDate</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span>
               <span class="n">resetPrimitive</span> <span class="kt">ResetPrimitive</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

       <span class="n">alias</span> <span class="n">payout</span><span class="kt">:</span>
               <span class="n">instruction</span> <span class="ow">-&gt;</span> <span class="n">payout</span>

       <span class="n">alias</span> <span class="n">observationDate</span><span class="kt">:</span>
               <span class="kr">if</span> <span class="n">instruction</span> <span class="ow">-&gt;</span> <span class="n">rateRecordDate</span> <span class="n">exists</span>
               <span class="kr">then</span> <span class="n">instruction</span> <span class="ow">-&gt;</span> <span class="n">rateRecordDate</span>
               <span class="kr">else</span> <span class="n">resetDate</span>

       <span class="n">alias</span> <span class="n">observationIdentifiers</span><span class="kt">:</span>
               <span class="kr">if</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">equityPayout</span> <span class="n">count</span> <span class="ow">=</span> <span class="mi">1</span> <span class="kr">then</span> <span class="kt">ResolveEquityObservationIdentifiers</span><span class="p">(</span><span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">equityPayout</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span><span class="p">,</span> <span class="n">resetDate</span><span class="p">)</span>
               <span class="kr">else</span> <span class="kr">if</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="n">exists</span> <span class="kr">then</span> <span class="kt">ResolveInterestRateObservationIdentifiers</span><span class="p">(</span><span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span><span class="p">,</span> <span class="n">observationDate</span><span class="p">)</span>

       <span class="n">alias</span> <span class="n">observation</span><span class="kt">:</span>
               <span class="kt">ResolveObservation</span><span class="p">([</span><span class="n">observationIdentifiers</span><span class="p">],</span> <span class="n">empty</span><span class="p">)</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">resetPrimitive</span> <span class="ow">-&gt;</span> <span class="n">before</span><span class="kt">:</span>
               <span class="n">tradeState</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">resetPrimitive</span> <span class="ow">-&gt;</span> <span class="n">after</span><span class="kt">:</span>
               <span class="n">tradeState</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">resetPrimitive</span> <span class="ow">-&gt;</span> <span class="n">after</span> <span class="ow">-&gt;</span> <span class="n">resetHistory</span><span class="kt">:</span>
       <span class="kr">if</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">equityPayout</span> <span class="n">count</span> <span class="ow">=</span> <span class="mi">1</span> <span class="kr">then</span> <span class="kt">ResolveEquityReset</span><span class="p">(</span><span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">equityPayout</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">resetDate</span><span class="p">)</span>
               <span class="kr">else</span> <span class="kr">if</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span> <span class="n">exists</span> <span class="kr">then</span> <span class="kt">ResolveInterestRateReset</span><span class="p">(</span><span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">interestRatePayout</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">resetDate</span><span class="p">,</span> <span class="n">instruction</span> <span class="ow">-&gt;</span> <span class="n">rateRecordDate</span><span class="p">)</span>
</pre></div>
</div>
<p>First, <code class="docutils literal notranslate"><span class="pre">ResolveEquityObservationIdentifiers</span></code> defines the specific product definition terms used to resolve <code class="docutils literal notranslate"><span class="pre">ObservationIdentifier``s.</span> <span class="pre">An</span> <span class="pre">``ObservationIdentifier</span></code> uniquely identifies an <code class="docutils literal notranslate"><span class="pre">Observation</span></code>, which inside holds a single item of market data and in this scenario will hold an equity price.</p>
<p>Specifying precisely which attributes from <code class="docutils literal notranslate"><span class="pre">EquityPayout</span></code> should be used to resolve the equity price is important to ensure consistent equity price resolution for all model adopters.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">ResolveEquityObservationIdentifiers:</span>
       <span class="n">inputs</span><span class="kt">:</span>
               <span class="n">payout</span> <span class="kt">EquityPayout</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">date</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span>
               <span class="n">identifiers</span> <span class="kt">ObservationIdentifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

       <span class="n">alias</span> <span class="n">periodEndDate</span><span class="kt">:</span>
               <span class="kt">CalculationPeriod</span><span class="p">(</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">calculationPeriodDates</span><span class="p">,</span> <span class="n">date</span> <span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">endDate</span>

       <span class="n">alias</span> <span class="n">equityValuation</span><span class="kt">:</span>
               <span class="kr">if</span> <span class="kt">CalculationPeriod</span><span class="p">(</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">calculationPeriodDates</span><span class="p">,</span> <span class="n">periodEndDate</span> <span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">isLastPeriod</span> <span class="kr">then</span>
                       <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">priceReturnTerms</span> <span class="ow">-&gt;</span> <span class="n">valuationPriceFinal</span>
                       <span class="kr">else</span> <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">priceReturnTerms</span> <span class="ow">-&gt;</span> <span class="n">valuationPriceInterim</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">identifiers</span> <span class="ow">-&gt;</span> <span class="n">observable</span> <span class="ow">-&gt;</span> <span class="n">productIdentifier</span><span class="kt">:</span>
               <span class="n">payout</span> <span class="ow">-&gt;</span> <span class="n">underlier</span> <span class="ow">-&gt;</span> <span class="n">security</span> <span class="ow">-&gt;</span> <span class="n">productIdentifier</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">identifiers</span> <span class="ow">-&gt;</span> <span class="n">observationDate</span><span class="kt">:</span>
               <span class="kt">ResolveEquityValuationDate</span><span class="p">(</span><span class="n">equityValuation</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">identifiers</span> <span class="ow">-&gt;</span> <span class="n">observationTime</span><span class="kt">:</span>
               <span class="kt">ResolveEquityValuationTime</span><span class="p">(</span><span class="n">equityValuation</span><span class="p">,</span> <span class="n">identifiers</span> <span class="ow">-&gt;</span> <span class="n">observable</span> <span class="ow">-&gt;</span> <span class="n">productIdentifier</span> <span class="n">only</span><span class="o">-</span><span class="n">element</span><span class="p">)</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">identifiers</span> <span class="ow">-&gt;</span> <span class="n">determinationMethodology</span> <span class="ow">-&gt;</span> <span class="n">determinationMethod</span><span class="kt">:</span>
               <span class="n">equityValuation</span> <span class="ow">-&gt;</span> <span class="n">determinationMethod</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ResolveObservation</span></code> provides an interface for adopters to integrate their market data systems. It specifies the input types and the output type, which ensures the integrity of the observed value.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">ResolveObservation:</span>
       <span class="n">inputs</span><span class="kt">:</span>
               <span class="n">identifiers</span> <span class="kt">ObservationIdentifier</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
               <span class="n">averagingMethod</span> <span class="kt">AveragingMethodEnum</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span>
               <span class="n">observation</span> <span class="kt">Observation</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The construction of the <code class="docutils literal notranslate"><span class="pre">Reset</span></code> in our scenario then becomes trivial, once the equity price has been retrieved, as the equity price and reset date are simply assigned to the corresponding attributes on the <code class="docutils literal notranslate"><span class="pre">Reset</span></code>.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">func</span> <span class="kt">ResolveEquityReset:</span>
       <span class="n">inputs</span><span class="kt">:</span>
               <span class="n">equityPayout</span> <span class="kt">EquityPayout</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">observation</span> <span class="kt">Observation</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">date</span> <span class="n">date</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">output</span><span class="kt">:</span>
               <span class="n">reset</span> <span class="kt">Reset</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">reset</span> <span class="ow">-&gt;</span> <span class="n">resetValue</span><span class="kt">:</span>
               <span class="n">observation</span> <span class="ow">-&gt;</span> <span class="n">observedValue</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">reset</span> <span class="ow">-&gt;</span> <span class="n">resetDate</span><span class="kt">:</span>
               <span class="n">date</span>

       <span class="n">assign</span><span class="o">-</span><span class="n">output</span> <span class="n">reset</span> <span class="ow">-&gt;</span> <span class="n">observations</span><span class="kt">:</span>
               <span class="n">observation</span>
</pre></div>
</div>
</div>
<div class="section" id="workflow-step-creation">
<h4>Workflow Step Creation<a class="headerlink" href="#workflow-step-creation" title="Permalink to this headline">¶</a></h4>
<p>(<em>This feature is currently being developed and will be documented upon release in the CDM</em>)</p>
</div>
</div>
</div>
<div class="section" id="reference-data-model">
<h2>Reference Data Model<a class="headerlink" href="#reference-data-model" title="Permalink to this headline">¶</a></h2>
<p>The CDM only integrates the reference data components that are specifically needed to model the in-scope products, events, legal agreements and function components.</p>
<p>This translates into the representation of the <strong>party</strong> and <strong>legal entity</strong>.</p>
<p>Parties are not explicitly qualified as a legal entity or a natural person, although the model provides the ability to associate a person (or set of persons) to a party, which use case would imply that such party would be a legal entity (even if not formally specified as such).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LegalEntity</span></code> type is used when only a legal entity reference is appropriate i.e. the value would never be that of a natural person.</p>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">Party:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">partyId</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">name</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">person</span> <span class="kt">NaturalPerson</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">account</span> <span class="kt">Account</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">NaturalPerson:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">honorific</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">firstName</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">middleName</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">initial</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
  <span class="n">surname</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">suffix</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">dateOfBirth</span> <span class="n">date</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">type</span> <span class="kt">LegalEntity:</span>
  <span class="p">[</span><span class="n">metadata</span> <span class="n">key</span><span class="p">]</span>
  <span class="n">entityId</span> <span class="n">string</span> <span class="p">(</span><span class="mi">0</span><span class="o">..*</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
  <span class="n">name</span> <span class="n">string</span> <span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">metadata</span> <span class="n">scheme</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="mapping-synonym">
<h2>Mapping (Synonym)<a class="headerlink" href="#mapping-synonym" title="Permalink to this headline">¶</a></h2>
<p>In order to facilitate the translation of existing industry messages (based on open standards or proprietary ones) into CDM, the CDM is mapped to a set of those alternative data representations using the Rosetta DSL <em>synonym</em> feature, as described in the <a class="reference external" href="https://docs.rosetta-technology.io/dsl/documentation.html#mapping-component">Mapping Component Section</a>.</p>
<p>The following set of synonym sources are currently in place for the CDM:</p>
<ul class="simple">
<li><strong>FpML standard</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">FpML_5_10</span></code>): synonyms to the version 5.10 of the FpML standard</li>
<li><strong>FIX standard</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">FIX_5_0_SP2</span></code>): synonyms to the version 5.0 SP2 of the FIX protocol</li>
<li><strong>ISO 20022 standard</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">ISO_20022</span></code>): synonyms to the ISO 20022 reporting standard, with no version reference at present</li>
<li><strong>Workflow event</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">Workflow_Event</span></code>): synonyms to the <em>event.xsd</em> schema used internally in Rosetta to ingest sample lifecycle events</li>
<li><strong>DTCC</strong> (synonym sources: <code class="docutils literal notranslate"><span class="pre">DTCC_11_0</span></code> and <code class="docutils literal notranslate"><span class="pre">DTCC_9_0</span></code>): synonyms to the <em>OTC_Matching_11-0.xsd</em> schema used for trade matching confirmations, and to the <em>OTC_Matching_9-0.xsd</em> schema used for payment notifications, both including the imported FpML schema version 4.9.</li>
<li><strong>CME</strong> (synonym sources: <code class="docutils literal notranslate"><span class="pre">CME_ClearedConfirm_1_17</span></code> and <code class="docutils literal notranslate"><span class="pre">CME_SubmissionIRS_1_0</span></code>): synonyms to the <em>cme-conf-ext-1-17.xsd</em> schema (including the imported FpML schema version 5.0) used for clearing confirmation, and to the <em>bloombergTradeFixml</em> schema (including the imported FpML schema version 4.6) used for clearing submission</li>
<li><strong>AcadiaSoft</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">AcadiaSoft_AM_1_0</span></code>): synonyms to version 1.0 of AcadiaSoft Agreement Manager</li>
<li><strong>ISDA Create</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">ISDA_Create_1_0</span></code>): synonyms to version 1.0 of the ISDA Create tool for Initial Margin negotiation</li>
<li><strong>ORE</strong> (synonym source: <code class="docutils literal notranslate"><span class="pre">ORE_1_0_39</span></code>): synonyms to version 1.0.39 of the ORE XML Model</li>
</ul>
<p>Those synonym sources are listed as part of a configuration file in the CDM using a special <code class="docutils literal notranslate"><span class="pre">synonym</span> <span class="pre">source</span></code> enumeration, so that the synonym source value can be controlled when editing synonyms.</p>
</div>
<div class="section" id="namespace">
<h2>Namespace<a class="headerlink" href="#namespace" title="Permalink to this headline">¶</a></h2>
<p>The CDM is partitioned into groups of namespaces. A namespace is an abstract container created to hold a logical grouping of model artefacts. The approach is designed to make it easier for users to understand the model structure and adopt selected components. It also aids the development cycle by insulating groups of components from unrelated model changes that may occur. The partitioning is visible to users in Rosetta Core by toggling the Namespace view in the left hand panel, and in the generated code files.</p>
<div class="section" id="model-artifacts">
<h3>Model Artifacts<a class="headerlink" href="#model-artifacts" title="Permalink to this headline">¶</a></h3>
<p>Model artifacts are organised into a directory hierarchy that is exposed in the model editor.</p>
</div>
<div class="section" id="organising-principles">
<h3>Organising Principles<a class="headerlink" href="#organising-principles" title="Permalink to this headline">¶</a></h3>
<p>Namespaces are organised into a hierarchy, with layers going from in to out. The hierarchy contains an intrinsic inheritance structure where each layer has access to (“imports”) the layer outside, and is designed to be usable without any of its inner layers. Layers can contain several namespaces (“siblings”), which can also refer to each other.</p>
<p>Example – the base namespace</p>
<div class="figure">
<img alt="_images/cdm-namespace.png" src="_images/cdm-namespace.png" />
</div>
<p>In the example above the layers of the “base” namespace can be observed. There are four layers to the namespace. The outer layer “base” contains one file and three namespaces. The next layer contains three siblings, “datetime”, “math”, and “staticdata”. A third and fourth layer is contained within the “staticdata” namespace.</p>
</div>
<div class="section" id="hierarchy-structure">
<h3>Hierarchy Structure<a class="headerlink" href="#hierarchy-structure" title="Permalink to this headline">¶</a></h3>
<p>The namespace hierarchy in the CDM contains 7 components</p>
<ul class="simple">
<li>Base – contains basic concepts used across the model: date, time, maths, static data</li>
<li>Event – contains business event concepts: primitive, contract state, and associated state transition function specifications</li>
<li>Legal Agreement – contains generic documentation concepts: legal agreement, contract, and credit support specifications</li>
<li>Observable – contains observable concepts: market data, holiday calendars, asset class specific specifications</li>
<li>Product – contains generic product concepts: quantity, price, economic terms and payout, that are built using template features</li>
<li>Regulation – contains regulation concepts: regulatory bodies, corpus, report definitions and field rules</li>
<li>Synonym – contains model to model synonym mappings</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to the ISDA CDM documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, ISDA.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.119.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>